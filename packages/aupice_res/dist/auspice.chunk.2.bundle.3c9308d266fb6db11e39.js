(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1121:function(e,t,n){(function(e){var r,i,o,a;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==s(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){e.exports=n(2)()},function(t,n){t.exports=e},function(e,t,n){"use strict";var r=n(3);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),o=n(0),a=n.n(o),c=function(e){return 0!==e};function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e){return(u="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)})(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(o,e);var t,n,r=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),y(f(t=r.call(this,e)),"continueOpenCollapsible",(function(){var e=f(t).innerRef;t.setState({height:e.scrollHeight,transition:"height ".concat(t.props.transitionTime,"ms ").concat(t.props.easing),isClosed:!1,hasBeenOpened:!0,inTransition:c(e.scrollHeight),shouldOpenOnNextCycle:!1})})),y(f(t),"handleTriggerClick",(function(e){t.props.triggerDisabled||t.state.inTransition||(e.preventDefault(),t.props.handleTriggerClick?t.props.handleTriggerClick(t.props.accordionPosition):!0===t.state.isClosed?(t.openCollapsible(),t.props.onOpening(),t.props.onTriggerOpening()):(t.closeCollapsible(),t.props.onClosing(),t.props.onTriggerClosing()))})),y(f(t),"handleTransitionEnd",(function(e){e.target===t.innerRef&&(t.state.isClosed?(t.setState({inTransition:!1}),t.props.onClose()):(t.setState({height:"auto",overflow:t.props.overflowWhenOpen,inTransition:!1}),t.props.onOpen()))})),y(f(t),"setInnerRef",(function(e){return t.innerRef=e})),t.timeout=void 0,t.contentId=e.contentElementId||"collapsible-content-".concat(Date.now()),t.triggerId=e.triggerElementProps.id||"collapsible-trigger-".concat(Date.now()),e.open?t.state={isClosed:!1,shouldSwitchAutoOnNextCycle:!1,height:"auto",transition:"none",hasBeenOpened:!0,overflow:e.overflowWhenOpen,inTransition:!1}:t.state={isClosed:!0,shouldSwitchAutoOnNextCycle:!1,height:0,transition:"height ".concat(e.transitionTime,"ms ").concat(e.easing),hasBeenOpened:!1,overflow:"hidden",inTransition:!1},t}return t=o,(n=[{key:"componentDidUpdate",value:function(e,t){var n=this;this.state.shouldOpenOnNextCycle&&this.continueOpenCollapsible(),"auto"!==t.height&&0!==t.height||!0!==this.state.shouldSwitchAutoOnNextCycle||(window.clearTimeout(this.timeout),this.timeout=window.setTimeout((function(){n.setState({height:0,overflow:"hidden",isClosed:!0,shouldSwitchAutoOnNextCycle:!1})}),50)),e.open!==this.props.open&&(!0===this.props.open?(this.openCollapsible(),this.props.onOpening()):(this.closeCollapsible(),this.props.onClosing()))}},{key:"componentWillUnmount",value:function(){window.clearTimeout(this.timeout)}},{key:"closeCollapsible",value:function(){var e=this.innerRef;this.setState({shouldSwitchAutoOnNextCycle:!0,height:e.scrollHeight,transition:"height ".concat(this.props.transitionCloseTime?this.props.transitionCloseTime:this.props.transitionTime,"ms ").concat(this.props.easing),inTransition:c(e.scrollHeight)})}},{key:"openCollapsible",value:function(){this.setState({inTransition:c(this.innerRef.scrollHeight),shouldOpenOnNextCycle:!0})}},{key:"renderNonClickableTriggerElement",value:function(){var e=this.props,t=e.triggerSibling,n=e.classParentString;if(!t)return null;switch(u(t)){case"string":return i.a.createElement("span",{className:"".concat(n,"__trigger-sibling")},t);case"function":return t();case"object":return t;default:return null}}},{key:"render",value:function(){var e=this,t={height:this.state.height,WebkitTransition:this.state.transition,msTransition:this.state.transition,transition:this.state.transition,overflow:this.state.overflow},n=this.state.isClosed?"is-closed":"is-open",r=this.props.triggerDisabled?"is-disabled":"",o=!1===this.state.isClosed&&void 0!==this.props.triggerWhenOpen?this.props.triggerWhenOpen:this.props.trigger,a=this.props.contentContainerTagName,s=this.props.triggerTagName,c=this.props.lazyRender&&!this.state.hasBeenOpened&&this.state.isClosed&&!this.state.inTransition?null:this.props.children,u=this.props,p=u.classParentString,h=u.contentOuterClassName,d=u.contentInnerClassName,f="".concat(p,"__trigger ").concat(n," ").concat(r," ").concat(this.state.isClosed?this.props.triggerClassName:this.props.triggerOpenedClassName),m="".concat(p," ").concat(this.state.isClosed?this.props.className:this.props.openedClassName),y="".concat(p,"__contentOuter ").concat(h),b="".concat(p,"__contentInner ").concat(d);return i.a.createElement(a,l({className:m.trim()},this.props.containerElementProps),i.a.createElement(s,l({id:this.triggerId,className:f.trim(),onClick:this.handleTriggerClick,style:this.props.triggerStyle&&this.props.triggerStyle,onKeyPress:function(t){var n=t.key;(" "===n&&"button"!==e.props.triggerTagName.toLowerCase()||"Enter"===n)&&e.handleTriggerClick(t)},tabIndex:this.props.tabIndex&&this.props.tabIndex,"aria-expanded":!this.state.isClosed,"aria-disabled":this.props.triggerDisabled,"aria-controls":this.contentId,role:"button"},this.props.triggerElementProps),o),this.renderNonClickableTriggerElement(),i.a.createElement("div",{id:this.contentId,className:y.trim(),style:t,onTransitionEnd:this.handleTransitionEnd,ref:this.setInnerRef,hidden:this.props.contentHiddenWhenClosed&&this.state.isClosed&&!this.state.inTransition,role:"region","aria-labelledby":this.triggerId},i.a.createElement("div",{className:b.trim()},c)))}}])&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.Component);b.propTypes={transitionTime:a.a.number,transitionCloseTime:a.a.number,triggerTagName:a.a.string,easing:a.a.string,open:a.a.bool,containerElementProps:a.a.object,triggerElementProps:a.a.object,contentElementId:a.a.string,classParentString:a.a.string,className:a.a.string,openedClassName:a.a.string,triggerStyle:a.a.object,triggerClassName:a.a.string,triggerOpenedClassName:a.a.string,contentOuterClassName:a.a.string,contentInnerClassName:a.a.string,accordionPosition:a.a.oneOfType([a.a.string,a.a.number]),handleTriggerClick:a.a.func,onOpen:a.a.func,onClose:a.a.func,onOpening:a.a.func,onClosing:a.a.func,onTriggerOpening:a.a.func,onTriggerClosing:a.a.func,trigger:a.a.oneOfType([a.a.string,a.a.element]),triggerWhenOpen:a.a.oneOfType([a.a.string,a.a.element]),triggerDisabled:a.a.bool,lazyRender:a.a.bool,overflowWhenOpen:a.a.oneOf(["hidden","visible","auto","scroll","inherit","initial","unset"]),contentHiddenWhenClosed:a.a.bool,triggerSibling:a.a.oneOfType([a.a.string,a.a.element,a.a.func]),tabIndex:a.a.number,contentContainerTagName:a.a.string,children:a.a.oneOfType([a.a.string,a.a.element])},b.defaultProps={transitionTime:400,transitionCloseTime:null,triggerTagName:"span",easing:"linear",open:!1,classParentString:"Collapsible",triggerDisabled:!1,lazyRender:!1,overflowWhenOpen:"hidden",contentHiddenWhenClosed:!1,openedClassName:"",triggerStyle:null,triggerClassName:"",triggerOpenedClassName:"",contentOuterClassName:"",contentInnerClassName:"",className:"",triggerSibling:null,onOpen:function(){},onClose:function(){},onOpening:function(){},onClosing:function(){},onTriggerOpening:function(){},onTriggerClosing:function(){},tabIndex:null,contentContainerTagName:"div",triggerElementProps:{}},t.default=b}])},"object"==s(t)&&"object"==s(e)?e.exports=a(n(1)):(i=[n(1)],void 0===(o="function"==typeof(r=a)?r.apply(t,i):r)||(e.exports=o))}).call(this,n(934)(e))},1122:function(e,t,n){e.exports=n.p+"f66966ba89ed36ecbe0e4e0688cb1ef9.png"},1123:function(e,t,n){e.exports=n.p+"4dc6198ec0d867620d300be40d112a10.jpg"},1124:function(e,t){e.exports={version:"2.41.0"}},1125:function(e,t,n){e.exports=n.p+"6c602efcee22c1bc67ad0a46ed8e87e3.png"},848:function(e,t,n){"use strict";var r=n(1),i=n.n(r);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),r)}var i,a}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(l,e);var t,n,r,o=c(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).state={hasError:!1},t}return t=l,r=[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}],(n=[{key:"componentDidCatch",value:function(e,t){console.error(e),console.error(t)}},{key:"render",value:function(){return this.state.hasError?this.props.showNothing?null:i.a.createElement("h1",null,"Something went wrong."):this.props.children}}])&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(i.a.Component);t.a=p},849:function(e,t,n){"use strict";var r=n(1),i=n.n(r),o=n(234),a=n.n(o);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===s(t)?t:String(t)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(a,e);var t,n,r,o=d(a);function a(){return u(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"getStyles",value:function(){return{base:{display:"flex",flexDirection:this.props.direction,flexWrap:this.props.wrap,justifyContent:this.props.justifyContent,alignItems:this.props.alignItems,alignContent:this.props.alignContent,order:this.props.order,flexGrow:this.props.grow,flexShrink:this.props.shrink,flexBasis:this.props.basis,alignSelf:this.props.alignSelf},style:this.props.style}}},{key:"render",value:function(){var e=this.getStyles();return i.a.createElement("div",{id:this.props.id,onClick:this.props.clickHandler,style:l(l({},e.base),e.style)},this.props.children)}}])&&p(t.prototype,n),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a.Component);y(g,"propTypes",{direction:a.a.oneOf(["row","rowReverse","column","columnReverse"]),wrap:a.a.oneOf(["nowrap","wrap","wrap-reverse"]),justifyContent:a.a.oneOf(["flex-start","flex-end","center","space-between","space-around"]),alignItems:a.a.oneOf(["flex-start","flex-end","center","baseline","stretch"]),alignContent:a.a.oneOf(["flex-start","flex-end","center","space-between","space-around","stretch"]),grow:a.a.number,shrink:a.a.number,basis:a.a.string,order:a.a.number,alignSelf:a.a.oneOf(["auto","flex-start","flex-end","center","baseline","stretch"]),children:a.a.node.isRequired,clickHandler:a.a.func}),y(g,"defaultProps",{direction:"row",wrap:"nowrap",justifyContent:"center",alignItems:"center",alignContent:"stretch",grow:0,shrink:1,basis:"auto",alignSelf:"auto",order:0,style:{},clickHandler:function(){}}),t.a=g},858:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n(832),i=n(818),o=n(852),a={country:"countries",authors:"authors"},s=function(e,t){return 1===t?"authors"===e&&(e="author"):(e in a&&(e=a[e]),"s"!==e.slice(-1).toLowerCase()&&(e+="s")),e=e.replace(/_/g," ")},c=function(e){var t="number"==typeof e?Object(r.g)(e):e,n=t.split("-");return 3===n.length?"".concat(i.G[n[1]]," ").concat(n[0]):t},l=function(e){var t=e.nodes,n=e.visibility,r=e.mainTreeNumTips,i=e.branchLengthsToDisplay,a=e.filters,l=e.visibleStateCounts,u=e.t,p=Object(o.d)(t,n),h=Object(o.e)(t,n),d="";d+="divOnly"!==i&&p>0?u("Showing {{x}} of {{y}} genomes sampled between {{from}} and {{to}}",{x:p,y:r,from:c(h[0]),to:c(h[1])}):u("Showing {{x}} of {{y}} genomes",{x:p,y:r}),d+=".";var f=[];Object.keys(a).forEach((function(e){var t=Object.keys(l[e]).length;t&&f.push("".concat(t," ").concat(s(e,t)))}));var m=u("Comprising"),y=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.prefix,i=void 0===r?void 0:r,o=n.suffix,a=void 0===o?void 0:o,s=n.capatalise,c=void 0===s||s,l=n.fullStop,u=void 0===l||l;return e.length?(t=1===e.length?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1],i&&(t=i+" "+t),a&&(t+=" "+a),c&&(t=t.charAt(0).toUpperCase()),u&&(t+="."),t+" "):""}(f,{prefix:m,capatalise:!1});return y.length?d+=" ".concat(y):d.endsWith(".")?d+=" ":d+=". ",d}},866:function(e,t,n){"use strict";n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return O}));var r=n(1),i=n.n(r),o=n(797),a=n(827),s=n(899);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=o.c.div.withConfig({displayName:"filterBadge__BaseContainer",componentId:"sc-f9gznr-0"})(["color:#5097BA;cursor:pointer;font-weight:300;padding:0px 2px 0px 2px;"]),d=Object(o.c)(h).withConfig({displayName:"filterBadge__TextContainer",componentId:"sc-f9gznr-1"})(["display:inline-block;cursor:help;margin:0px 0px 0px 2px;"]),f=o.c.div.withConfig({displayName:"filterBadge__IconContainer",componentId:"sc-f9gznr-2"})(["cursor:pointer;color:#5097BA;border-width:0px 0px 0px 1px;border-style:solid;border-color:#BDD8E5;*/ min-width:20px;padding:0px 1px 0px 5px;display:inline-block;text-align:center;&:hover,&:focus{& > svg{color:#0071e6;}}& > svg{transform:translate(-2px,2px);}"]),m=Object(o.c)(h).withConfig({displayName:"filterBadge__UnselectedFilterTextContainer",componentId:"sc-f9gznr-3"})(["margin:1px 2px 1px 2px;padding:0px 2px 0px 2px;&:hover{text-decoration:underline;}"]),y=Object(o.c)(h).withConfig({displayName:"filterBadge__SelectedFilterTextContainer",componentId:"sc-f9gznr-4"})(["background-color:#E9F2F6;border-radius:2px;border:1px solid #BDD8E5;border-width:1;border-radius:2px;margin:0px 2px 0px 0px;&:hover{text-decoration:none;}"]),b=o.c.div.withConfig({displayName:"filterBadge__BadgeContainer",componentId:"sc-f9gznr-5"})(["background-color:#E9F2F6;",";display:inline-block;font-size:14px;border-radius:2px;border-width:1px;border-style:solid;border-color:#BDD8E5;"],(function(e){return e.striped?"background: repeating-linear-gradient(135deg, #E9F2F6, #E9F2F6 5px, #FFFFFF 5px, #FFFFFF 10px);":""})),g=Object(o.c)(s.a).withConfig({displayName:"filterBadge__StyledTooltip",componentId:"sc-f9gznr-6"})(["max-width:30vh;font-weight:400;white-space:normal;line-height:1.2;padding:4px !important;& > br{margin-bottom:10px;}"]),v=function(e){var t=e.id,n=e.children;return i.a.createElement(g,{place:"bottom",type:"dark",effect:"solid",delayShow:300,id:t},n)},w=function(e){var t=e.remove,n=e.canMakeInactive,r=e.active,o=e.activate,s=e.inactivate,c=e.children,l=e.id,u=e.onHoverMessage,p=void 0===u?"The visible data is being filtered by this":u;return i.a.createElement(b,{striped:n&&!r},i.a.createElement(d,{active:!n||r,"data-tip":!0,"data-for":l},c),i.a.createElement(v,{id:l},n&&!r?"This filter is currently inactive":p),n&&i.a.createElement(f,{onClick:r?s:o,role:"button",tabIndex:0,"data-tip":!0,"data-for":l+"active"},r?i.a.createElement(a.l,null):i.a.createElement(a.m,null),i.a.createElement(v,{id:l+"active"},r?"Inactivate this filter":"Re-activate this filter")),i.a.createElement(f,{onClick:t,role:"button",tabIndex:0},i.a.createElement(a.q,{"data-tip":!0,"data-for":l+"remove"}),i.a.createElement(v,{id:l+"remove"},"Remove this filter")))},O=function(e){var t=e.onClick,n=e.extraStyles,r=void 0===n?{}:n,o=e.active,a=e.children,s=o?y:m;return i.a.createElement("div",{style:u({display:"inline-block"},r)},i.a.createElement(s,{onClick:t},a))}},867:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return h}));var r=n(1),i=n.n(r),o=function(e){var t=e.theme,n=e.selected,r=e.width,o=n?t.selectedColor:t.unselectedColor;return i.a.createElement("svg",{width:r,height:r+5},i.a.createElement("g",{transform:"translate(0,2)"},i.a.createElement("svg",{width:r,height:r,viewBox:"16 19 27 22"},i.a.createElement("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",transform:"translate(17.000000, 20.000000)"},i.a.createElement("polyline",{id:"Path-3",stroke:o,points:"2.94117647 12.8571429 2.94117647 18.6083984 17.8459616 18.6083984 17.8459616 16.0260882 24.870031 16.0260882"}),i.a.createElement("polyline",{id:"Path-4",stroke:o,points:"17.8500004 18.5714286 17.8500004 20 25.0119374 20"}),i.a.createElement("polyline",{id:"Path-5",stroke:o,points:"2.94117647 12.8571429 3.00303284 7.21191058 10.2360102 7.11220045 10.4159559 2.99881623 17.1561911 2.93803403 17.1561911 0 24.313534 0"}),i.a.createElement("polyline",{id:"Path-6",stroke:o,points:"17.1599998 2.85714286 17.1599998 4.28571429 24.512941 4.28571429"}),i.a.createElement("path",{d:"M0,12.8571429 L2.94117647,12.8571429",id:"Path-6",stroke:o}),i.a.createElement("polyline",{id:"Path-7",stroke:o,points:"10.2941176 7.14285714 10.2941176 11.4285714 24.5454676 11.4285714"})))))},a=function(e){var t=e.theme,n=e.selected,r=e.width,o=n?t.selectedColor:t.unselectedColor;return i.a.createElement("svg",{width:r,height:r+5},i.a.createElement("g",{transform:"translate(0,4)"},i.a.createElement("svg",{width:r,height:r,viewBox:"0 0 30 30 "},i.a.createElement("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",transform:"translate(17.000000, 20.000000)"},i.a.createElement("polyline",{id:"Path-3",stroke:o,points:"-15 5 -15 -25 "}),i.a.createElement("polyline",{id:"Path-4",stroke:o,points:"-15 5 25 5"}),i.a.createElement("polyline",{id:"Path-5",stroke:o,points:"-12 3 20 -25 "}),i.a.createElement("circle",{id:"c-1",stroke:o,cx:"-8",cy:"0",r:"2"}),i.a.createElement("circle",{id:"c-2",stroke:o,cx:"4",cy:"-10",r:"2"}),i.a.createElement("circle",{id:"c-3",stroke:o,cx:"4",cy:"-15",r:"2"}),i.a.createElement("circle",{id:"c-4",stroke:o,cx:"-4",cy:"-5",r:"2"}),i.a.createElement("circle",{id:"c-5",stroke:o,cx:"-2",cy:"-11",r:"2"})))))},s=function(e){var t=e.theme,n=e.selected,r=e.width,o=n?t.selectedColor:t.unselectedColor;return i.a.createElement("svg",{width:r,height:r+5},i.a.createElement("g",{transform:"translate(0,4)"},i.a.createElement("svg",{width:r,height:r,viewBox:"0 0 30 30 "},i.a.createElement("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",transform:"translate(17.000000, 20.000000)"},i.a.createElement("polyline",{id:"Path-3",stroke:o,points:"-15 5 -15 -25 "}),i.a.createElement("polyline",{id:"Path-4",stroke:o,points:"-15 5 25 5"}),i.a.createElement("circle",{id:"c-1",stroke:o,cx:"-8",cy:"0",r:"2"}),i.a.createElement("circle",{id:"c-2",stroke:o,cx:"3",cy:"0",r:"2"}),i.a.createElement("circle",{id:"c-3",stroke:o,cx:"8",cy:"-5",r:"2"}),i.a.createElement("circle",{id:"c-4",stroke:o,cx:"-4",cy:"-15",r:"2"}),i.a.createElement("circle",{id:"c-5",stroke:o,cx:"1",cy:"-11",r:"2"})))))},c=function(e){var t=e.theme,n=e.selected,r=e.width,o=n?t.selectedColor:t.unselectedColor;return i.a.createElement("svg",{width:r,height:r+5},i.a.createElement("g",{transform:"translate(0,0)"},i.a.createElement("svg",{width:r,height:r,viewBox:"14 14 25 26"},i.a.createElement("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",transform:"translate(15.000000, 15.000000)"},i.a.createElement("path",{d:"M15,15 L17.6450195,15",id:"Path-12",stroke:o}),i.a.createElement("path",{d:"M15.229248,22.5795898 L15.229248,18.2854004 C15.229248,18.2854004 17.8465223,17.6291504 17.8508301,15.0574951 C17.8551378,12.4858398 15.2944336,11.9138184 15.2944336,11.9138184 L15.229248,7.53540039",id:"Path-13",stroke:o}),i.a.createElement("path",{d:"M7.63037109,6.10498047 L10.230957,9.08325195 C10.230957,9.08325195 12.25,7.08233714 15.126709,7.04162598 C18.003418,7.00091481 20.5390625,8.91748047 20.5390625,8.91748047 L22.9765625,5.60839844",id:"Path-14",stroke:o}),i.a.createElement("path",{d:"M0.15942005,4.99135298 L2.76065146,7.96962446 C2.76065146,7.96962446 4.78019556,5.96870965 7.65761856,5.92799848 C10.5350415,5.88728732 13.0713154,7.80385298 13.0713154,7.80385298 L15.5094204,4.49477094",id:"Path-14",stroke:o,transform:"translate(7.834420, 6.232198) rotate(-34.000000) translate(-7.834420, -6.232198) "}),i.a.createElement("path",{d:"M7.5,21.496582 L10.1005859,24.4748535 C10.1005859,24.4748535 12.1196289,22.4739387 14.9963379,22.4332275 C17.8730469,22.3925164 20.4086914,24.309082 20.4086914,24.309082 L22.8461914,21",id:"Path-14",stroke:o,transform:"translate(15.173096, 22.737427) scale(1, -1) translate(-15.173096, -22.737427) "})))))},l=function(e){var t=e.theme,n=e.selected,r=e.width,o=n?t.selectedColor:t.unselectedColor;return i.a.createElement("svg",{width:r,height:r+5},i.a.createElement("g",{transform:"translate(0,2)"},i.a.createElement("svg",{width:r,height:r,viewBox:"106 49 150 118"},i.a.createElement("polyline",{id:"Path-2",stroke:o,strokeWidth:"4",fill:"none",points:"108 77 125.182237 87.8599894 133.381156 119.402591 111.867082 144.368016"}),i.a.createElement("path",{d:"M125.2,87.5 L137.624777,70",id:"Path-3",stroke:o,strokeWidth:"4",fill:"none"}),i.a.createElement("polyline",{id:"Path-4",stroke:o,strokeWidth:"4",fill:"none",points:"133 119.331781 192.127357 119.400002 215.445998 80.3916603 203.946476 51.4000015"}),i.a.createElement("path",{d:"M215.5,80.5 L253.378522,73",id:"Path-5",stroke:o,strokeWidth:"4",fill:"none"}),i.a.createElement("path",{d:"M192,119.2 L229.854937,164.55391",id:"Path-6",stroke:o,strokeWidth:"4",fill:"none"}))))},u=function(e){var t=e.theme,n=e.selected,r=e.width,o=n?t.selectedColor:t.unselectedColor;return i.a.createElement("svg",{width:r,height:r+5},i.a.createElement("g",{transform:"translate(0,7)"},i.a.createElement("svg",{width:r,height:r,viewBox:"0 0 30 30 "},i.a.createElement("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.a.createElement("line",{stroke:o,x1:"3.3",y1:"3.8",x2:"27.7",y2:"3.8"}),i.a.createElement("line",{stroke:o,x1:"3.3",y1:"9.2",x2:"27.7",y2:"9.2"}),i.a.createElement("line",{stroke:o,x1:"3.3",y1:"14.5",x2:"27.7",y2:"14.5"}),i.a.createElement("line",{stroke:o,x1:"3.3",y1:"19.9",x2:"27.7",y2:"19.9"}),i.a.createElement("line",{stroke:o,x1:"3.3",y1:"25.2",x2:"27.7",y2:"25.2"})))))},p=function(e){var t=e.theme,n=e.selected,r=e.width,o=n?t.selectedColor:t.unselectedColor;return i.a.createElement("svg",{width:r,height:r+5},i.a.createElement("g",{transform:"translate(0,6)"},i.a.createElement("svg",{width:r,height:r,viewBox:"0 0 30 30 "},i.a.createElement("g",{id:"Group",stroke:"none",strokeWidth:"1",fillRule:"evenodd"},i.a.createElement("rect",{fill:"none",stroke:o,x:"1",y:"1",width:"14",height:"17"}),i.a.createElement("rect",{fill:"none",stroke:o,x:"15",y:"1",width:"14",height:"17"}),i.a.createElement("rect",{fill:"none",stroke:o,x:"1",y:"18",width:"28",height:"8"})))))},h=function(e){var t=e.theme,n=e.selected,r=e.width,o=n?t.selectedColor:t.unselectedColor;return i.a.createElement("svg",{width:r,height:r+5},i.a.createElement("g",{transform:"translate(0,6)"},i.a.createElement("svg",{width:r,height:r,viewBox:"0 0 30 30 "},i.a.createElement("g",{id:"Group",stroke:"none",strokeWidth:"1",fillRule:"evenodd"},i.a.createElement("rect",{fill:"none",stroke:o,x:"1",y:"1",width:"7",height:"25"}),i.a.createElement("rect",{fill:"none",stroke:o,x:"8",y:"1",width:"20",height:"25"})))))}},884:function(e,t,n){"use strict";var r,i=n(1),o=n.n(i),a=n(796),s=n(930),c=n(825),l=n(822),u=function(e){var t=e.dispatch,n=e.transform,r=e.clipId,i=e.legendRectSize,a=e.legendSpacing,s=e.rectStroke,u=e.rectFill,p=e.label,h=e.value;return o.a.createElement("g",{transform:n,onMouseEnter:function(){t(Object(c.f)({selectedLegendItem:h}))},onMouseLeave:function(){t(Object(c.f)())}},o.a.createElement("rect",{style:{strokeWidth:2},width:i,height:i,fill:u,stroke:s}),o.a.createElement("text",{x:i+a+5,y:i-a,style:{fontSize:12,fill:l.a,fontFamily:l.b},clipPath:r?"url(#".concat(r,")"):void 0},o.a.createElement("title",null,p),p))},p=n(818),h=n(834),d=n(832),f=n(819);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===m(o)?o:String(o)),r)}var i,o}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var i=S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O(this,n)}}function O(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=Object(a.b)((function(e){return{colorBy:e.controls.colorBy,colorings:e.metadata.colorings,colorScale:e.controls.colorScale,legendOpen:e.controls.legendOpen}}))(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(a,e);var t,n,r,i=w(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"showLegend",value:function(){return void 0!==this.props.legendOpen?this.props.legendOpen:!(this.props.width<600||this.props.colorScale.visibleLegendValues.length>32)}},{key:"getSVGHeight",value:function(){if(!this.showLegend())return 18;var e=this.props.colorScale.visibleLegendValues.length;return 19*Math.ceil(e/2)+4+20||100}},{key:"getSVGWidth",value:function(){return this.showLegend()?290:this.getTitleWidth()+20}},{key:"getTransformationForLegendItem",value:function(e,t){var n=Math.floor(t/e),r=t%e*19;return"translate(".concat(145*n+10,",").concat(r,")")}},{key:"getTitleWidth",value:function(){return 15+5.3*Object(h.f)(this.props.colorings,this.props.colorBy).length}},{key:"toggleLegend",value:function(){this.props.dispatch({type:f.R,value:!this.props.legendOpen})}},{key:"legendTitle",value:function(){return o.a.createElement("g",{id:"Title"},o.a.createElement("rect",{width:this.getTitleWidth(),height:"12",fill:"rgba(255,255,255,.85)"}),o.a.createElement("text",{x:this.getTitleOffset(),y:10,style:{fontSize:12,fill:l.a,fontFamily:l.d,backgroundColor:"#fff"}},Object(h.f)(this.props.colorings,this.props.colorBy)))}},{key:"legendChevron",value:function(){var e=this.showLegend()?-180:0,t=this.getArrowOffset();return o.a.createElement("g",{id:"Chevron",transform:"translate(".concat(t,",0)")},o.a.createElement("svg",{width:"12",height:"12",viewBox:"0 0 1792 1792"},o.a.createElement("rect",{width:"1792",height:"1792",fill:"rgba(255,255,255,.85)"}),o.a.createElement("path",{fill:l.a,style:{transform:"rotate(".concat(e,"deg)"),transformOrigin:"50% 50%",transition:"".concat(p.u,"ms ease-in-out")},d:"M1683 808l-742 741q-19 19-45 19t-45-19l-742-741q-19-19-19-45.5t19-45.5l166-165q19-19 45-19t45 19l531 531 531-531q19-19 45-19t45 19l166 165q19 19 19 45.5t-19 45.5z"})))}},{key:"styleLabelText",value:function(e){if(this.props.colorScale.legendLabels&&this.props.colorScale.legendLabels.has(e))return this.props.colorScale.legendLabels.get(e);if("num_date"===this.props.colorBy||"temporal"===this.props.colorScale.scaleType){var t=this.props.colorScale.visibleLegendValues;if(t[t.length-1]-t[0]>10&&t[t.length-1]-parseInt(e,10)>=10)return parseInt(e,10);var n=y(Object(d.g)(e).split("-"),3),r=n[0],i=n[1];return n[2],"".concat(p.G[i]," ").concat(r)}return e}},{key:"legendItems",value:function(){var e=this,t=this.props.colorScale.visibleLegendValues,n=Math.ceil(t.length/2),r=t.filter((function(e){return void 0!==e})).map((function(t,r){return o.a.createElement(u,{dispatch:e.props.dispatch,legendRectSize:15,legendSpacing:4,rectFill:Object(h.e)(e.props.colorScale.scale(t)),rectStroke:Object(s.g)(e.props.colorScale.scale(t)).toString(),transform:e.getTransformationForLegendItem(n,r),key:e.props.colorScale.colorBy+t+r,value:t,label:e.styleLabelText(t),index:r,clipId:r<n?"legendFirstColumnClip":void 0})}));return o.a.createElement("g",{id:"ItemsContainer"},o.a.createElement("rect",{width:this.getSVGWidth(),height:this.getSVGHeight(),fill:"rgba(255,255,255,.85)"}),o.a.createElement("clipPath",{id:"legendFirstColumnClip"},o.a.createElement("rect",{x:"0",y:"0",width:140,height:this.getSVGHeight(),fill:"rgb(150, 154, 223)"})),o.a.createElement("g",{id:"Items",transform:"translate(0,20)"},r))}},{key:"getContainerStyles",value:function(){var e={position:"absolute",top:26,borderRadius:4,zIndex:1e3,userSelect:"none"};return e[this.props.right?"right":"left"]=5,e}},{key:"getArrowOffset",value:function(){return this.props.right?this.getSVGWidth()-20:this.getTitleWidth()}},{key:"getTitleOffset",value:function(){return this.props.right?this.getSVGWidth()-this.getTitleWidth()-15:5}},{key:"render",value:function(){var e=this;return this.props.colorScale?o.a.createElement("svg",{id:"TreeLegendContainer",width:this.getSVGWidth(),height:this.getSVGHeight(),style:this.getContainerStyles()},this.legendItems(),o.a.createElement("g",{id:"TitleAndChevron",onClick:function(){return e.toggleLegend()},style:{cursor:"pointer",textAlign:"right"}},this.legendTitle(),this.legendChevron())):null}}])&&g(t.prototype,n),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.a.Component))||r;t.a=x},918:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"c",(function(){return P})),n.d(t,"d",(function(){return L}));var r,i=n(1),o=n.n(i),a=n(796),s=n(797),c=n(817),l=n(827),u=n(822),p=n(819),h=n(849),d=n(1124),f=n(924),m=n(836);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===y(o)?o:String(o)),r)}var i,o}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var i=S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O(this,n)}}function O(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=n(1125),j=Object(i.lazy)((function(){return n.e(3).then(n.bind(null,1143))})),E=o.a.createElement("span",{style:{marginLeft:10,marginRight:10}},"•"),k=s.c.div.withConfig({displayName:"fine-print__FinePrintStyles",componentId:"sc-129vvgi-0"})(["margin-left:30px;padding-bottom:30px;font-family:",";font-size:15px;font-weight:300;color:rgb(136,136,136);line-height:1.4;.line{margin-top:20px;margin-bottom:20px;border-bottom:1px solid #CCC;}.finePrint{font-size:14px;}.logoContainer{padding:1px 1px;margin-right:5px;width:24px;cursor:pointer;}.logo{margin-left:1px;margin-right:1px;margin-top:1px;margin-bottom:3px;}"],u.b),T=Object(a.b)((function(e){return{tree:e.tree,metadata:e.metadata,browserDimensions:e.browserDimensions.browserDimensions}}))(r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(a,e);var t,n,r,i=w(a);function a(){return b(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"shouldComponentUpdate",value:function(e){return this.props.browserDimensions!==e.browserDimensions}},{key:"getUpdated",value:function(){var e=this.props.t;return this.props.metadata.updated?o.a.createElement("span",null,e("Data updated")," ",this.props.metadata.updated):null}},{key:"downloadDataButton",value:function(){var e=this,t=this.props.t;return o.a.createElement("button",{style:Object.assign({},u.g,{backgroundColor:"rgba(0,0,0,0)",color:u.h,margin:0,padding:0}),onClick:function(){e.props.dispatch({type:p.db})}},o.a.createElement(l.g,null),o.a.createElement("span",{style:{position:"relative"}}," "+t("Download data")))}},{key:"render",value:function(){if(!this.props.metadata||!this.props.tree.nodes)return null;var e=this.props.width-30;return o.a.createElement(k,null,o.a.createElement("div",{style:{width:e}},o.a.createElement(h.a,{className:"finePrint"},this.getUpdated(),E,this.downloadDataButton(),E,"Auspice v"+d.version),o.a.createElement("div",{style:{height:"5px"}}),L(),P()))}}])&&g(t.prototype,n),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.a.Component))||r,C=Object(c.a)()(T);function P(){return o.a.createElement(h.a,{className:"finePrint"},o.a.createElement("a",{className:"logoContainer",href:"https://nextstrain.org"},o.a.createElement("img",{alt:"nextstrain.org",className:"logo",width:"24px",src:x})),"Powered by Nextstrain (",o.a.createElement("a",{href:f.b.nextstrain.href,target:"_blank",rel:"noopener noreferrer"},f.b.nextstrain.author," ",o.a.createElement("i",null,f.b.nextstrain.journal)),")")}function L(){var e=Object(m.b)("finePrint")?Object(m.a)("finePrint"):null;return e?o.a.createElement(i.Suspense,{fallback:o.a.createElement(o.a.Fragment,null)},o.a.createElement(h.a,{className:"finePrint"},o.a.createElement(j,{mdstring:e}))):null}t.b=C},922:function(e,t,n){"use strict";n.d(t,"b",(function(){return De}));var r=n(1),i=n.n(r),o=n(817),a=n(827),s=n(825),c=n(843),l=n(884),u=n(822),p=n(1114),h=n(839),d=function(e){return 1===e["stroke-width"]?0:e["stroke-width"]>6?e["stroke-width"]+6:2*e["stroke-width"]},f=(n(838),n(818)),m=n(1160);var y=n(834);function b(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){var t=e.n.node_attrs&&e.n.node_attrs.hidden;return t&&("always"===t||"timetree"===t&&"num_date"===e.that.distance||"divtree"===t&&"div"===e.that.distance)?"hidden":"visible"},w=function(e,t){return e.branchStroke},O=function(e,t,n){if(e){var r="T".concat(e.that.id,"_").concat(e.n.parent.arrayIdx,"_").concat(e.n.arrayIdx),i=e.that.svg.select(Object(h.c)("#branchT",e.n.name));i.empty()||i.style("stroke",n);var o=e.that.svg.select(Object(h.c)("#branchS",e.n.name));if(!o.empty())if(e.branchStroke===e.n.parent.shell.branchStroke)o.style("stroke",n);else{var a=e.that.svg.select("#".concat(r,"_begin"));a&&a.attr("stop-color",t);var s=e.that.svg.select("#".concat(r,"_end"));s&&s.attr("stop-color",n)}}},S=n(873),x=n(832),j=n(823),E=function(e){return"aa"===e?"10px":"14px"},k=function(e){return"aa"===e?"500":"700"},T=function(e,t,n,r){return function(n){if(t)return"visible";if(n.visibility!==f.b)return"hidden";return n.n.tipCount>.03*r?"visible":"aa"===e||n.n.name!==n.n.parent.name&&"__ROOT"!==n.n.parent.name?"hidden":"visible"}},C=function(e){return"num_date"===e?function(e){return Object(x.i)("DAY",Object(x.h)(Object(j.h)(e.n,"num_date")))}:function(t){return Object(j.h)(t.n,e)}};function P(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I={attrs:{".tip":{r:function(e){return e.r},cx:function(e){return e.xTip},cy:function(e){return e.yTip}},".branch":{},".vaccineCross":{d:function(e){return e.vaccineCross}},".conf":{d:function(e){return e.confLine}}},styles:{".tip":{fill:function(e){return e.fill},stroke:function(e){return e.tipStroke},visibility:function(e){return e.visibility===f.b?"visible":"hidden"}},".conf":{stroke:function(e){return e.branchStroke},"stroke-width":d},".branch":{"stroke-width":function(e){return e["stroke-width"]+"px"},stroke:function(e){return w(e)},cursor:function(e){return e.visibility===f.b?"pointer":"default"},visibility:v}}},N=function(e,t){return function(n){I.attrs[e]&&P(t).filter((function(t){return I.attrs[e][t]})).forEach((function(t){n.attr(t,I.attrs[e][t])})),I.styles[e]&&P(t).filter((function(t){return I.styles[e][t]})).forEach((function(t){n.style(t,I.styles[e][t])}))}},_=function(e,t,n,r){e.selectAll(t).filter((function(e){return e.update})).transition().duration(r).call(n),r||Object(p.d)()},B=n(1153),A=n(1154),R=n(842),M=n(875);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e){return function(e){if(Array.isArray(e))return W(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||G(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||G(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){if(e){if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===D(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H=function e(t,n){var r=t.depth-t.pDepth;t.x=t.px+r*Math.cos(t.tau+.5*t.w),t.y=t.py+r*Math.sin(t.tau+.5*t.w);var i=t.tau;if(t.n.hasChildren)for(var o=0;o<t.n.children.length;o++){var a=t.n.children[o].shell;a.w=2*Math.PI*J(a.n)/n,a.tau=i,i+=a.w,a.px=t.x,a.py=t.y,e(a,n)}};function U(e,t){return t.step()>50?t.padding(.5):e.length<=4?t.padding(.4):e.length<=6?t.padding(.3):e.length<=10?t.padding(.2):t.padding(.1)}function K(e,t,n){var r=t.step();if(!(t.step()<=50)){for(var i=[],o=100;o--;)i.push((Math.random()-.5)*r*.5);var a=["".concat(e,"Base"),"".concat(e,"Tip"),i.length],s=a[0],c=a[1],l=a[2],u=0;!function e(t){if(t[s]=Object(h.j)(t.n).shell[c],t[c]+=i[u++],u>=l&&(u=0),t.n.hasChildren){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=G(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t.n.children);try{for(r.s();!(n=r.n()).done;){e(n.value.shell)}}catch(e){r.e(e)}finally{r.f()}}}(n[0])}}function Y(e,t){var n=0;if(t.length<e.tipLabelBreakL1){var r=e.tipLabelFontSizeL1;t.length<e.tipLabelBreakL2&&(r=e.tipLabelFontSizeL2),t.length<e.tipLabelBreakL3&&(r=e.tipLabelFontSizeL3),t.forEach((function(e){n<e.n.name.length&&(n=.65*e.n.name.length*r)}))}return n}function J(e){return e.tipCount+.15*(e.fullTipCount-e.tipCount)}var X=n(953),$=function(e,t,n){var r=this;this.grid=!1,this.attributes=["r","cx","cy","id","class","d"],this.params={regressionStroke:u.a,regressionWidth:6,majorGridStroke:"#DDD",majorGridWidth:2,minorGridStroke:"#EEE",minorGridWidth:1,tickLabelSize:12,tickLabelFill:u.a,minorTicks:4,orientation:[1,1],showGrid:!0,fillSelected:"#A73",radiusSelected:5,branchStroke:"#AAA",branchStrokeWidth:2,tipStroke:"#AAA",tipFill:"#CCC",tipStrokeWidth:1,tipRadius:4,fontFamily:u.b,branchLabelKey:!1,branchLabelFont:u.b,branchLabelFill:"#777",branchLabelFontWeight:500,branchLabelPadX:8,branchLabelPadY:5,tipLabels:!0,tipLabelFont:u.b,tipLabelFill:"#555",tipLabelPadX:8,tipLabelPadY:2,mapToScreenDebounceTime:500,tipLabelFontSizeL1:8,tipLabelFontSizeL2:10,tipLabelFontSizeL3:12,tipLabelBreakL1:75,tipLabelBreakL2:50,tipLabelBreakL3:25},this.groups={},this.id=t,this.nodes=e.map((function(e){var t={that:r,n:e,x:0,y:0,inView:void 0===e.inView||e.inView};return e.shell=t,t})),this.zoomNode=this.nodes[n],this.strainToNode={},this.nodes.forEach((function(e){r.strainToNode[e.n.name]=e}))};$.prototype.change=function(e){var t,n,r=e.changeColorBy,i=void 0!==r&&r,o=e.changeVisibility,a=void 0!==o&&o,s=e.changeTipRadii,c=void 0!==s&&s,l=e.changeBranchThickness,u=void 0!==l&&l,p=e.showConfidences,d=void 0!==p&&p,f=e.removeConfidences,m=void 0!==f&&f,y=e.zoomIntoClade,b=void 0!==y&&y,g=e.svgHasChangedDimensions,v=void 0!==g&&g,w=e.animationInProgress,O=void 0!==w&&w,S=e.changeNodeOrder,x=void 0!==S&&S,j=e.newDistance,E=void 0===j?void 0:j,k=e.newLayout,T=void 0===k?void 0:k,P=e.updateLayout,L=void 0===P?void 0:P,I=e.newBranchLabellingKey,N=void 0===I?void 0:I,_=e.showAllBranchLabels,B=void 0===_?void 0:_,A=e.newTipLabelKey,R=void 0===A?void 0:A,M=e.branchStroke,D=void 0===M?void 0:M,V=e.tipStroke,F=void 0===V?void 0:V,G=e.fill,W=void 0===G?void 0:G,z=e.visibility,q=void 0===z?void 0:z,H=e.tipRadii,U=void 0===H?void 0:H,K=e.branchThickness,Y=void 0===K?void 0:K,J=e.scatterVariables,X=void 0===J?void 0:J,$=new Set,Z={},Q=new Set,ee=T,te=500;Date.now()-this.timeLastRenderRequested<1e3&&(te=0),i&&($.add(".branch").add(".tip").add(".conf"),Q.add("stroke").add("fill"),Z.branchStroke=D,Z.tipStroke=F,Z.fill=W),a&&($.add(".tip").add(".tipLabel").add(".branchLabel"),Q.add("visibility").add("cursor"),Z.visibility=q),c&&($.add(".tip"),Q.add("r"),Z.r=U),u&&($.add(".branch").add(".conf"),Q.add("stroke-width"),Z["stroke-width"]=Y),(E||T||L||b||v||x)&&($.add(".tip").add(".branch.S").add(".branch.T").add(".branch"),$.add(".vaccineCross").add(".vaccineDottedLine").add(".conf"),$.add(".branchLabel").add(".tipLabel"),$.add(".grid").add(".regression"),Q.add("cx").add("cy").add("d").add("opacity").add("visibility")),x&&(Object(h.h)(this.nodes),this.setDistance()),t=this.nodes,n=Z,t.forEach((function(e,t){for(var r in e.update=!1,n){var i=n[r][t];i!==e[r]&&(e[r]=i,e.update=!0)}})),i&&this.updateColorBy(),a&&this.regression&&($.add(".regression"),this.calculateRegression()),b&&(this.nodes.forEach((function(e){e.inView=!1,e.update=!0})),this.zoomNode=b.n.hasChildren?b:b.n.parent.shell,Object(h.a)(this.zoomNode,(function(e){e.inView=!0}))),(v||x)&&this.nodes.forEach((function(e){e.update=!0})),(E||L)&&this.setDistance(E),(E||T||L||x)&&this.setLayout(T||this.layout,X),d&&(this.params.confidence=!0),void 0!==B&&(this.params.showAllBranchLabels=B,$.add(".branchLabel")),(Q.has(["stroke-width"])||E||T||x||L||b||v||d)&&this.mapToScreen(),R&&(this.callbacks.tipLabel=C(R),$.add(".tipLabel"));var ne={removeConfidences:m,showConfidences:d,newBranchLabellingKey:N};ne.timeSliceHasPotentiallyChanged=a||E,ne.hideTipLabels=O,ee?this.modifySVGInStages($,Q,te,1e3,ne):this.modifySVG($,Q,te,ne),this.timeLastRenderRequested=Date.now()},$.prototype.modifySVG=function(e,t,n,r){var i,o=this,a=[".tip",".vaccineDottedLine",".vaccineCross",".branch"];if(e.has(".branch.S")||e.has(".branch.T")){var s=e.has(".branch");s&&a.splice(a.indexOf(".branch"),1);[".S",".T"].forEach((function(r,a){e.has(".branch".concat(r))&&(i=s?function(e){N(".branch",t)(e),e.attr("d",(function(e){return e.branch[a]}))}:function(e){e.attr("d",(function(e){return e.branch[a]}))},_(o.svg,".branch".concat(r),i,n))}))}a.forEach((function(r){e.has(r)&&(i=N(r,t),_(o.svg,r,i,n))})),r.hideTipLabels?this.removeTipLabels():e.has(".tipLabel")&&this.updateTipLabels(),e.has(".grid")&&(this.grid&&"unrooted"!==this.layout?this.addGrid():this.hideGrid()),e.has(".regression")&&(this.removeRegression(),this.regression&&this.drawRegression()),r.removeConfidences&&this.confidencesInSVG?this.removeConfidence():r.showConfidences&&!this.confidencesInSVG?this.drawConfidence():e.has(".conf")&&this.confidencesInSVG&&(Object(S.c)(!0,this.distance,this.layout)?(i=N(".conf",t),_(this.svg,".conf",i,n)):this.removeConfidence()),r.timeSliceHasPotentiallyChanged&&this.showTemporalSlice(),r.newBranchLabellingKey?(this.removeBranchLabels(),"none"!==r.newBranchLabellingKey&&this.drawBranchLabels(r.newBranchLabellingKey)):e.has(".branchLabel")&&this.updateBranchLabels(n)},$.prototype.modifySVGInStages=function(e,t,n,r,i){var o=this;e.delete(".tip"),this.hideGrid();var a=0,s=function(){o.drawBranches(),o.params.showGrid&&o.addGrid(),o.svg.selectAll(".tip").remove(),o.updateTipLabels(),o.drawTips(),o.vaccines&&o.drawVaccines(),o.showTemporalSlice(),o.regression&&o.drawRegression(),e.has(".branchLabel")&&o.drawBranchLabels(i.newBranchLabellingKey||o.params.branchLabelKey)};this.confidencesInSVG=!1,this.svg.selectAll(P(e).join(", ")).transition().duration(n).style("opacity",0).remove().on("start",(function(){return a++})).on("end",(function(){if(!--a){o.setClipMask();var e=N(".tip",t);_(o.svg,".tip",e,r),setTimeout(s,r)}})),this.hideTemporalSlice(),n||Object(p.d)()},$.prototype.render=function(e,t,n,r,i,o,a,s,c,l,u,p,d,f,m){var y=this;this.svg=e,this.params=Object.assign(this.params,r),this.callbacks=i,this.vaccines=c?c.map((function(e){return e.shell})):void 0,this.dateRange=f,this.nodes.forEach((function(e,t){e.branchStroke=l[t],e.tipStroke=u[t],e.fill=p[t],e.visibility=a[t],e["stroke-width"]=o[t],e.r=d?d[t]:y.params.tipRadius})),Object(h.h)(this.nodes),this.setDistance(n),this.setLayout(t,m),this.mapToScreen(),this.setClipMask(),this.params.showGrid&&(this.addGrid(),this.showTemporalSlice()),this.drawBranches(),this.updateTipLabels(),this.drawTips(),this.params.branchLabelKey&&this.drawBranchLabels(this.params.branchLabelKey),this.vaccines&&this.drawVaccines(),this.regression&&this.drawRegression(),this.confidencesInSVG=!1,s&&this.drawConfidence(),this.timeLastRenderRequested=Date.now()},$.prototype.clearSVG=function(){this.svg.selectAll("*").remove()},$.prototype.setClipMask=function(){var e=[].concat(b(this.xScale.range()),b(this.yScale.range())),t=e[0],n=e[1],r=e[2],i=t-5,o=n-t+20,a=r-15,s=e[3]-r+20;this.groups.clipPath?this.groups.clipPath.select("rect").attr("x",i).attr("y",a).attr("width",o).attr("height",s):(this.groups.clipPath=this.svg.append("g").attr("id","clipGroup"),this.groups.clipPath.append("clipPath").attr("id","treeClip").append("rect").attr("x",i).attr("y",a).attr("width",o).attr("height",s))},$.prototype.drawTips=function(){var e=this.params;"tips"in this.groups||(this.groups.tips=this.svg.append("g").attr("id","tips").attr("clip-path","url(#treeClip)")),this.groups.tips.selectAll(".tip").data(this.nodes.filter((function(e){return!e.n.hasChildren}))).enter().append("circle").attr("class","tip").attr("id",(function(e){return Object(h.c)("tip",e.n.name)})).attr("cx",(function(e){return e.xTip})).attr("cy",(function(e){return e.yTip})).attr("r",(function(e){return e.r})).on("mouseover",this.callbacks.onTipHover).on("mouseout",this.callbacks.onTipLeave).on("click",this.callbacks.onTipClick).style("pointer-events","auto").style("visibility",(function(e){return e.visibility===f.b?"visible":"hidden"})).style("fill",(function(t){return t.fill||e.tipFill})).style("stroke",(function(t){return t.tipStroke||e.tipStroke})).style("stroke-width",(function(){return e.tipStrokeWidth})).style("cursor","pointer")},$.prototype.drawBranches=function(){var e=this.params;"branchTee"in this.groups||(this.groups.branchTee=this.svg.append("g").attr("id","branchTee").attr("clip-path","url(#treeClip)")),"clock"===this.layout||"scatter"===this.layout||"unrooted"===this.layout?this.groups.branchTee.selectAll("*").remove():this.groups.branchTee.selectAll(".branch").data(this.nodes.filter((function(e){return e.n.hasChildren}))).enter().append("path").attr("class","branch T").attr("id",(function(e){return Object(h.c)("branchT",e.n.name)})).attr("d",(function(e){return e.branch[1]})).style("stroke",(function(t){return t.branchStroke||e.branchStroke})).style("stroke-width",(function(t){return t["stroke-width"]||e.branchStrokeWidth})).style("visibility",v).style("fill","none").style("pointer-events","auto").on("mouseover",this.callbacks.onBranchHover).on("mouseout",this.callbacks.onBranchLeave).on("click",this.callbacks.onBranchClick),this.groups.branchGradientDefs||(this.groups.branchGradientDefs=this.svg.append("defs")),this.groups.branchGradientDefs.selectAll("*").remove(),this.updateColorBy(),"branchStem"in this.groups||(this.groups.branchStem=this.svg.append("g").attr("id","branchStem").attr("clip-path","url(#treeClip)")),this.groups.branchStem.selectAll(".branch").data(this.nodes).enter().append("path").attr("class","branch S").attr("id",(function(e){return Object(h.c)("branchS",e.n.name)})).attr("d",(function(e){return e.branch[0]})).style("stroke",(function(t){return t.branchStroke?w(t):e.branchStroke})).style("stroke-linecap","round").style("stroke-width",(function(t){return t["stroke-width"]||e.branchStrokeWidth})).style("visibility",v).style("cursor",(function(e){return e.visibility===f.b?"pointer":"default"})).style("pointer-events","auto").on("mouseover",this.callbacks.onBranchHover).on("mouseout",this.callbacks.onBranchLeave).on("click",this.callbacks.onBranchClick)},$.prototype.drawVaccines=function(){this.vaccines&&this.vaccines.length&&("vaccines"in this.groups||(this.groups.vaccines=this.svg.append("g").attr("id","vaccines")),this.groups.vaccines.selectAll(".vaccineCross").data(this.vaccines).enter().append("path").attr("class","vaccineCross").attr("d",(function(e){return e.vaccineCross})).style("stroke","#333").style("stroke-width",2*this.params.branchStrokeWidth).style("fill","none").style("cursor","pointer").style("pointer-events","auto").on("mouseover",this.callbacks.onTipHover).on("mouseout",this.callbacks.onTipLeave).on("click",this.callbacks.onTipClick))},$.prototype.drawRegression=function(){if(void 0!==this.regression.slope){var e,t,n,r=this.yScale(this.regression.intercept+this.xScale.domain()[0]*this.regression.slope),i=this.yScale(this.regression.intercept+this.xScale.domain()[1]*this.regression.slope),o="M "+this.xScale.range()[0].toString()+" "+r.toString()+" L "+this.xScale.range()[1].toString()+" "+i.toString();"regression"in this.groups||(this.groups.regression=this.svg.append("g").attr("id","regression").attr("clip-path","url(#treeClip)")),this.groups.regression.append("path").attr("d",o).attr("class","regression").style("fill","none").style("visibility","visible").style("stroke",this.params.regressionStroke).style("stroke-width",this.params.regressionWidth),this.groups.regression.append("text").text((e=this.regression,t=this.layout,n=this.yScale,"clock"===t?Object(h.f)(n)?"rate estimate: ".concat(e.slope.toExponential(2)," subs per site per year"):"rate estimate: ".concat(Object(h.b)(e.slope)," subs per year"):"intercept = ".concat(e.intercept.toPrecision(3),", slope = ").concat(e.slope.toPrecision(3),", R^2 = ").concat(e.r2.toPrecision(3)))).attr("class","regression").attr("x",this.xScale.range()[1]/2-75).attr("y",this.yScale.range()[0]+50).style("fill",this.params.regressionStroke).style("font-size",this.params.tickLabelSize+8).style("font-weight",400).style("font-family",this.params.fontFamily)}},$.prototype.removeRegression=function(){"regression"in this.groups&&this.groups.regression.selectAll("*").remove()},$.prototype.updateColorBy=function(){},$.prototype.setDistance=function(e){this.nodes.forEach((function(e){e.update=!0})),e&&(this.distance=e),["div","num_date"].includes(this.distance)||(console.error("Tree distance measure not set or invalid. Using `div`."),this.distance="div"),"div"===this.distance?this.nodes.forEach((function(e){e.depth=Object(j.e)(e.n),e.pDepth=Object(j.e)(Object(h.j)(e.n)),e.conf=[e.depth,e.depth]})):this.nodes.forEach((function(e){e.depth=Object(j.h)(e.n,"num_date"),e.pDepth=Object(j.h)(Object(h.j)(e.n),"num_date"),e.conf=Object(j.h)(e.n,"num_date",{confidence:!0})||[e.depth,e.depth]})),this.vaccines&&this.vaccines.forEach((function(e){e.crossDepth=e.depth}))},$.prototype.setLayout=function(e,t){void 0!==e&&e===this.layout||this.nodes.forEach((function(e){e.update=!0})),this.layout=void 0===e?"rect":e,this.regression=void 0,t&&(this.scatterVariables=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t)),"clock"===this.layout&&(this.scatterVariables.x="num_date",this.scatterVariables.y="div"),"rect"===this.layout?this.rectangularLayout():"clock"===this.layout||"scatter"===this.layout?this.scatterplotLayout():"radial"===this.layout?this.radialLayout():"unrooted"===this.layout&&this.unrootedLayout()},$.prototype.rectangularLayout=function(){this.nodes.forEach((function(e){e.y=e.displayOrder,e.x=e.depth,e.px=e.pDepth,e.py=e.y})),this.vaccines&&this.vaccines.forEach((function(e){e.xCross=e.crossDepth,e.yCross=e.y}))},$.prototype.scatterplotLayout=function(){var e=this;if(this.scatterVariables){var t="displayOrder"===this.scatterVariables.x||"displayOrder"===this.scatterVariables.y?Object(h.g)(this.nodes):void 0;this.nodes.forEach((function(n){if("div"===e.scatterVariables.x)n.x=Object(j.e)(n.n),n.px=Object(j.e)(Object(h.j)(n.n));else if("gt"===e.scatterVariables.x)n.x=n.n.currentGt,n.px=Object(h.j)(n.n).currentGt;else if("displayOrder"===e.scatterVariables.x){var r=F(t(n),2);n.x=r[0],n.px=r[1]}else n.x=Object(j.h)(n.n,e.scatterVariables.x),n.px=Object(j.h)(Object(h.j)(n.n),e.scatterVariables.x);if("div"===e.scatterVariables.y)n.y=Object(j.e)(n.n),n.py=Object(j.e)(Object(h.j)(n.n));else if("gt"===e.scatterVariables.y)n.y=n.n.currentGt,n.py=Object(h.j)(n.n).currentGt;else if("displayOrder"===e.scatterVariables.y){var i=F(t(n),2);n.y=i[0],n.py=i[1]}else n.y=Object(j.h)(n.n,e.scatterVariables.y),n.py=Object(j.h)(Object(h.j)(n.n),e.scatterVariables.y)})),this.vaccines&&this.vaccines.forEach((function(e){e.xCross=e.x,e.yCross=e.y})),this.scatterVariables.showRegression&&this.calculateRegression()}else console.error("Scatterplot called without variables")},$.prototype.unrootedLayout=function(){var e=J(this.nodes[0].n),t=1.5*Math.PI,n=this.nodes[0].n.children;this.nodes.forEach((function(e){e.x=void 0,e.y=void 0,e.px=void 0,e.py=void 0}));for(var r=0;r<n.length;r++){var i=n[r].shell;if(i.w=2*Math.PI*J(i.n)/e,i.w>0){var o=i.depth-this.nodes[0].depth;i.px=o*Math.cos(t+.5*i.w),i.py=o*Math.sin(t+.5*i.w),i.tau=t,H(i,e),t+=i.w}}this.vaccines&&this.vaccines.forEach((function(e){var t=e.crossDepth-e.depth;e.xCross=e.px+t*Math.cos(e.tau+.5*e.w),e.yCross=e.py+t*Math.sin(e.tau+.5*e.w)})),this.nodes.forEach((function(e){delete e.tau,delete e.w}))},$.prototype.radialLayout=function(){var e=this,t=Math.max.apply(Math,V(this.nodes.map((function(e){return e.displayOrder})).filter((function(e){return e})))),n=this.nodes[0].depth;this.nodes.forEach((function(e){var r=1.9*Math.PI*e.displayOrderRange[0]/t,i=1.9*Math.PI*e.displayOrderRange[1]/t;e.angle=1.9*Math.PI*e.displayOrder/t,e.y=(e.depth-n)*Math.cos(e.angle),e.x=(e.depth-n)*Math.sin(e.angle),e.py=e.y*(e.pDepth-n)/(e.depth-n+1e-15),e.px=e.x*(e.pDepth-n)/(e.depth-n+1e-15),e.yCBarStart=(e.depth-n)*Math.cos(r),e.xCBarStart=(e.depth-n)*Math.sin(r),e.yCBarEnd=(e.depth-n)*Math.cos(i),e.xCBarEnd=(e.depth-n)*Math.sin(i),e.smallBigArc=Math.abs(i-r)>1*Math.PI})),this.vaccines&&this.vaccines.forEach((function(t){"div"===e.distance?(t.xCross=t.x,t.yCross=t.y):(t.xCross=(t.crossDepth-n)*Math.sin(t.angle),t.yCross=(t.crossDepth-n)*Math.cos(t.angle))}))},$.prototype.setScales=function(){"scatter"!==this.layout||this.scatterVariables.xContinuous?this.xScale=Object(R.a)():this.xScale=Object(M.a)().round(!1).align(.5).padding(.5),"scatter"!==this.layout||this.scatterVariables.yContinuous?this.yScale=Object(R.a)():this.yScale=Object(M.a)().round(!1).align(.5).padding(.5);var e=parseInt(this.svg.attr("width"),10),t=parseInt(this.svg.attr("height"),10);if("radial"===this.layout||"unrooted"===this.layout){var n=e-this.margins.left-this.margins.right,r=t-this.margins.bottom-this.margins.top,i=Object(B.a)([n,r]),o=n-i,a=r-i;this.xScale.range([.5*o+this.margins.left,e-.5*o-this.margins.right]),this.yScale.range([.5*a+this.margins.top,t-.5*a-this.margins.bottom])}else this.params.orientation[0]>0?this.xScale.range([this.margins.left,e-this.margins.right]):this.xScale.range([e-this.margins.right,this.margins.left]),this.params.orientation[1]>0?this.yScale.range([this.margins.top,t-this.margins.bottom]):this.yScale.range([t-this.margins.bottom,this.margins.top])},$.prototype.mapToScreen=function(){var e=this,t=this.nodes.filter((function(e){return!e.n.hasChildren})).filter((function(e){return e.inView}));this.margins={left:"scatter"===this.layout||"clock"===this.layout?40:5,right:5+Y(this.params,t),top:"radial"===this.layout?10:15,bottom:35},this.setScales(),this.setClipMask();var n,r,i,o,a=this.nodes.filter((function(e){return e.inView&&void 0!==e.y&&void 0!==e.x}));if("scatter"===this.layout&&!1===this.scatterVariables.showBranches&&(a=a.filter((function(e){return!e.n.hasChildren}))),"scatter"!==this.layout||this.scatterVariables.xContinuous){var s=1e6,c=-1e5;a.forEach((function(e){e.x<s&&(s=e.x),e.x>c&&(c=e.x)})),s===c&&(s-=.005,c+=.005);(i=c-s)<1e-8&&(c=1e-8-s,i=1e-8),"rect"===this.layout&&0!==this.zoomNode.n.arrayIdx&&(s-=(c-s)/20),n=[s,c]}else{var l=new Set(a.map((function(e){return e.x})));U(n=this.scatterVariables.xDomain.filter((function(e){return l.has(e)})),this.xScale)}if("scatter"!==this.layout||this.scatterVariables.yContinuous){var u=1e6,p=-1e5;if(a.forEach((function(e){e.y<u&&(u=e.y),e.y>p&&(p=e.y)})),t.length<30){var d=.05*(p-u);u-=d,p+=d}o=p-u,r=[u,p]}else{var f=new Set(a.map((function(e){return e.y})));U(r=this.scatterVariables.yDomain.filter((function(e){return f.has(e)})),this.yScale)}if("radial"===this.layout||"unrooted"===this.layout){var m=Object(A.a)([o,i]),y=i>o?.5*(i-o):0,b=i<o?.5*(o-i):0;n=[n[0]-b,n[0]+m-b],r=[r[0]-y,r[0]+m-y]}"clock"!==this.layout&&"scatter"!==this.layout||r.reverse(),this.xScale.domain(n),this.yScale.domain(r);var g=this.yScale.range()[1]+100,v=this.xScale.range()[0]-100;if(this.nodes.forEach((function(t){t.xTip=e.xScale(t.x),t.yTip=e.yScale(t.y),t.xBase=e.xScale(t.px),t.yBase=e.yScale(t.py),t.rot=180*Math.atan2(t.yTip-t.yBase,t.xTip-t.xBase)/Math.PI})),"scatter"===this.layout&&(this.scatterVariables.yContinuous||K("y",this.yScale,this.nodes),this.scatterVariables.xContinuous||K("x",this.xScale,this.nodes),this.nodes.forEach((function(e){isNaN(e.xTip)&&(e.xTip=v),isNaN(e.yTip)&&(e.yTip=g),isNaN(e.xBase)&&(e.xBase=v),isNaN(e.yBase)&&(e.yBase=g)}))),this.vaccines&&this.vaccines.forEach((function(t){var n=e.xScale(t.xCross),r=e.yScale(t.yCross);t.vaccineCross=" M ".concat(n-6,",").concat(r-6," L ").concat(n+6,",").concat(r+6," M ").concat(n-6,",").concat(r+6," L ").concat(n+6,",").concat(r-6)})),"unrooted"===this.layout)this.nodes.forEach((function(e){e.branch=[" M "+e.xBase.toString()+","+e.yBase.toString()+" L "+e.xTip.toString()+","+e.yTip.toString(),""]}));else if("clock"===this.layout||"scatter"===this.layout)this.scatterVariables.showBranches?this.nodes.forEach((function(e){e.branch=e.xBase===v||e.xTip===v||e.yBase===g||e.yTip===g?[""]:[" M "+e.xBase.toString()+","+e.yBase.toString()+" L "+e.xTip.toString()+","+e.yTip.toString(),""]})):this.nodes.forEach((function(e){e.branch=[]}));else if("rect"===this.layout)this.nodes.forEach((function(t){var n=.5*(Object(h.j)(t.n).shell["stroke-width"]-t["stroke-width"])||0,r=[e.yScale(t.displayOrderRange[0]),e.yScale(t.displayOrderRange[1])];t.branch=[[" M ".concat(t.xBase-n,",").concat(t.yBase," L ").concat(t.xTip,",").concat(t.yTip+.01)],[" M ".concat(t.xTip,",").concat(r[0]," L ").concat(t.xTip,",").concat(r[1])]],e.params.confidence&&(t.confLine=" M ".concat(e.xScale(t.conf[0]),",").concat(t.yBase," L ").concat(e.xScale(t.conf[1]),",").concat(t.yTip))}));else if("radial"===this.layout){var w=this.nodes[0].depth,O=this.nodes.map((function(e){return.5*(Object(h.j)(e.n).shell["stroke-width"]-e["stroke-width"])||0}));this.nodes.forEach((function(t,n){t.branch=[" M "+(t.xBase-O[n]*Math.sin(t.angle)).toString()+" "+(t.yBase-O[n]*Math.cos(t.angle)).toString()+" L "+t.xTip.toString()+" "+t.yTip.toString(),""],t.n.hasChildren&&(t.branch[1]=[" M "+e.xScale(t.xCBarStart).toString()+" "+e.yScale(t.yCBarStart).toString()+" A "+(e.xScale(t.depth)-e.xScale(w)).toString()+" "+(e.yScale(t.depth)-e.yScale(w)).toString()+" 0 "+(t.smallBigArc?"1 ":"0 ")+" 1  "+e.xScale(t.xCBarEnd).toString()+","+e.yScale(t.yCBarEnd).toString()])}))}},$.prototype.calculateRegression=function(){"clock"===this.layout?this.regression=function(e){var t=e.filter((function(e){return!e.n.hasChildren&&e.visibility===f.b})),n=t.length;if(0===n)return{slope:void 0,intercept:void 0,r2:void 0};var r=e[0].x,i=Object(m.a)(t.map((function(e){return e.y*(e.x-r)})))/n/(Object(m.a)(t.map((function(e){return(e.x-r)*(e.x-r)})))/n);return{slope:i,intercept:-r*i,r2:void 0}}(this.nodes):this.regression=function(e){var t=e.filter((function(e){return!e.n.hasChildren&&void 0!==e.x&&void 0!==e.y&&e.visibility===f.b})),n=t.length;if(0===n)return{slope:void 0,intercept:void 0,r2:void 0};var r=Object(m.a)(t.map((function(e){return e.x})))/n,i=Object(m.a)(t.map((function(e){return e.y})))/n,o=Object(m.a)(t.map((function(e){return(e.x-r)*(e.y-i)})))/Object(m.a)(t.map((function(e){return Math.pow(e.x-r,2)}))),a=i-o*r,s=1-Object(m.a)(t.map((function(e){return Math.pow(e.y-(a+o*e.x),2)})))/Object(m.a)(t.map((function(e){return Math.pow(e.y-i,2)})));return{slope:o,intercept:a,r2:s}}(this.nodes)},$.prototype.removeConfidence=function(e){this.confidencesInSVG=!1,"confidenceIntervals"in this.groups&&(e?this.groups.confidenceIntervals.selectAll("*").transition().duration(e).style("opacity",0).remove():this.groups.confidenceIntervals.selectAll("*").remove())},$.prototype.drawConfidence=function(e){var t=this;this.confidencesInSVG=!0,"confidenceIntervals"in this.groups||(this.groups.confidenceIntervals=this.svg.append("g").attr("id","confidenceIntervals")),e?(this.groups.confidenceIntervals.selectAll(".conf").data(this.nodes).enter().call((function(e){return t.drawSingleCI(e,0)})),this.groups.confidenceIntervals.transition().duration(e).style("opacity",.5)):this.groups.confidenceIntervals.selectAll(".conf").data(this.nodes).enter().call((function(e){return t.drawSingleCI(e,.5)}))},$.prototype.drawSingleCI=function(e,t){e.append("path").attr("class","conf").attr("id",(function(e){return Object(h.c)("conf",e.n.name)})).attr("d",(function(e){return e.confLine})).style("stroke",(function(e){return e.branchStroke||"#888"})).style("opacity",t).style("fill","none").style("stroke-width",d).style("pointer-events","none")},$.prototype.drawBranchLabels=function(e){var t=this;this.params.branchLabelKey=e;var n=E(e),r=k(e),i=T(e,this.params.showAllBranchLabels,this.layout,this.zoomNode.n.tipCount);"branchLabels"in this.groups||(this.groups.branchLabels=this.svg.append("g").attr("id","branchLabels").attr("clip-path","url(#treeClip)")),this.groups.branchLabels.selectAll(".branchLabel").data(this.nodes.filter((function(t){return t.n.branch_attrs&&t.n.branch_attrs.labels&&t.n.branch_attrs.labels[e]}))).enter().append("text").attr("class","branchLabel").attr("x",(function(e){return e.xTip+(t.params.orientation[0]>0?-5:5)})).attr("y",(function(e){return e.yTip-t.params.branchLabelPadY})).style("text-anchor",this.params.orientation[0]>0?"end":"start").style("visibility",i).style("fill",this.params.branchLabelFill).style("font-family",this.params.branchLabelFont).style("font-weight",r).style("font-size",n).style("pointer-events","none").text((function(t){return t.n.branch_attrs.labels[e]}))},$.prototype.removeBranchLabels=function(){this.params.branchLabelKey=void 0,"branchLabels"in this.groups&&this.groups.branchLabels.selectAll("*").remove()},$.prototype.updateBranchLabels=function(e){var t=this;if(this.groups.branchLabels){var n=T(this.params.branchLabelKey,this.params.showAllBranchLabels,this.layout,this.zoomNode.n.tipCount),r=E(this.params.branchLabelKey),i=k(this.params.branchLabelKey);this.groups.branchLabels.selectAll(".branchLabel").transition().duration(e).attr("x",(function(e){return e.xTip-5})).attr("y",(function(e){return e.yTip-t.params.branchLabelPadY})).style("visibility",n).style("font-weight",i).style("font-size",r),e||Object(p.d)()}},$.prototype.updateTipLabels=function(e){var t=this;"tipLabels"in this.groups?this.groups.tipLabels.selectAll("*").remove():this.groups.tipLabels=this.svg.append("g").attr("id","tipLabels");var n=this.callbacks.tipLabel,r=this.params.tipLabelPadX,i=this.params.tipLabelPadY,o=this.nodes.filter((function(e){return!e.n.hasChildren})).filter((function(e){return e.inView})),a=o.filter((function(e){return e.visibility===f.b}));if(a.length<this.params.tipLabelBreakL1){var s=this.params.tipLabelFontSizeL1;o.length<this.params.tipLabelBreakL3?s=this.params.tipLabelFontSizeL3:o.length<this.params.tipLabelBreakL2&&(s=this.params.tipLabelFontSizeL2),window.setTimeout((function(){t.groups.tipLabels.selectAll(".tipLabel").data(a).enter().append("text").attr("x",(function(e){return e.xTip+r})).attr("y",(function(e){return e.yTip+i})).text((function(e){return n(e)})).attr("class","tipLabel").style("font-size",s.toString()+"px").style("visibility",(function(e){return e.visibility===f.b?"visible":"hidden"}))}),e)}},$.prototype.removeTipLabels=function(){"tipLabels"in this.groups&&this.groups.tipLabels.selectAll("*").remove()},$.prototype.hideGrid=X.c,$.prototype.addGrid=X.a,$.prototype.showTemporalSlice=X.e,$.prototype.hideTemporalSlice=X.d;var Z=$,Q=n(954),ee=n(956),te=function(e,t,n,r){var i={},o={},a=e?n.tree:n.treeToo,s=e?r.tree:r.treeToo;if(t.dateRange=[r.dateMinNumeric,r.dateMaxNumeric],a.selectedStrain&&!s.selectedStrain&&(o.selectedNode={}),!s.nodeColorsVersion||a.nodeColorsVersion===s.nodeColorsVersion&&r.colorByConfidence===n.colorByConfidence||(i.changeColorBy=!0,i.branchStroke=Object(y.a)(s,r.colorByConfidence,r.colorBy),i.tipStroke=s.nodeColors,i.fill=s.nodeColors.map(y.e)),s.visibilityVersion&&a.visibilityVersion!==s.visibilityVersion&&(i.changeVisibility=!0,i.visibility=s.visibility),s.tipRadiiVersion&&a.tipRadiiVersion!==s.tipRadiiVersion&&(i.changeTipRadii=!0,i.tipRadii=s.tipRadii),a.branchThicknessVersion!==s.branchThicknessVersion&&(i.changeBranchThickness=!0,i.branchThickness=s.branchThickness),n.distanceMeasure!==r.distanceMeasure&&(i.newDistance=r.distanceMeasure),n.explodeAttr!==r.explodeAttr&&(i.changeNodeOrder=!0),!0===n.canRenderBranchLabels&&!1===r.canRenderBranchLabels?i.newBranchLabellingKey="none":(!1===n.canRenderBranchLabels&&!0===r.canRenderBranchLabels||n.selectedBranchLabel!==r.selectedBranchLabel||!1===n.scatterVariables.showBranches&&!0===r.scatterVariables.showBranches)&&(i.newBranchLabellingKey=r.selectedBranchLabel),n.showAllBranchLabels!==r.showAllBranchLabels&&(i.showAllBranchLabels=r.showAllBranchLabels),n.tipLabelKey!==r.tipLabelKey&&(i.newTipLabelKey=r.tipLabelKey),!0===n.temporalConfidence.display&&!1===r.temporalConfidence.display||!0===n.temporalConfidence.on&&!1===r.temporalConfidence.on?i.removeConfidences=!0:!0===r.temporalConfidence.display&&!1===n.temporalConfidence.on&&!0===r.temporalConfidence.on&&(i.showConfidences=!0),"scatter"!==r.layout&&"clock"!==r.layout||n.scatterVariables===r.scatterVariables||(i.updateLayout=!0,i.scatterVariables=r.scatterVariables),n.layout!==r.layout&&(i.newLayout=r.layout),a.idxOfInViewRootNode!==s.idxOfInViewRootNode){var c=t.nodes[s.idxOfInViewRootNode];i.zoomIntoClade=c,o.selectedNode={},"unrooted"===r.layout&&(i.updateLayout=!0)}n.width===r.width&&n.height===r.height||(i.svgHasChangedDimensions=!0),e&&n.showTreeToo!==r.showTreeToo&&(i.svgHasChangedDimensions=!0);var l=Object.keys(i).length;return l&&(i.animationInProgress="Pause"===r.animationPlayPauseButton,t.change(i)),[!!Object.keys(o).length&&o,l]},ne=function(e){e.visibility===f.b&&((1===e.that.params.orientation[0]?this.state.tree:this.state.treeToo).svg.select(Object(h.c)("#tip",e.n.name)).attr("r",(function(e){return e.r+4})),this.setState({selectedNode:{node:e,type:"tip",event:"hover"}}))},re=function(e){e.visibility===f.b&&(this.props.narrativeMode||(this.setState({selectedNode:{node:e,type:"tip",event:"click"}}),this.props.dispatch(Object(s.a)("add",f.M,[e.n.name]))))},ie=function(e){if(e.visibility===f.b){if(function(e){e&&O(e,Object(y.g)(e.n.parent.shell.branchStroke),Object(y.g)(e.branchStroke))}(e),this.props.temporalConfidence.exists&&this.props.temporalConfidence.display&&!this.props.temporalConfidence.on){var t=1===e.that.params.orientation[0]?this.state.tree:this.state.treeToo;"confidenceIntervals"in t.groups||(t.groups.confidenceIntervals=t.svg.append("g").attr("id","confidenceIntervals")),t.groups.confidenceIntervals.selectAll(".conf").data([e]).enter().call((function(e){return t.drawSingleCI(e,.5)}))}this.setState({selectedNode:{node:e,type:"branch",event:"hover"}})}},oe=function(e){if(e.visibility===f.b&&!this.props.narrativeMode)if(window.event.shiftKey)this.setState({selectedNode:{node:e,type:"branch",event:"click"}});else{var t,n,r=[void 0,void 0];if(e.n.branch_attrs&&void 0!==e.n.branch_attrs.labels&&(n=Object.keys(e.n.branch_attrs.labels).filter((function(e){return"aa"!==e}))),n&&n.length){var i=this.props.tree.availableBranchLabels;n.sort((function(e,t){return i.indexOf(e)-i.indexOf(t)}));var o=n[0];t="".concat(o,":").concat(e.n.branch_attrs.labels[o])}var a=1===e.that.params.orientation[0]?this.props.tree.observedMutations:this.props.treeToo.observedMutations,c=Object(h.d)(e.n)===e.n.arrayIdx?Object(h.e)(e.n,this.props.distanceMeasure,a).arrayIdx:e.n.arrayIdx;1===e.that.params.orientation[0]?r[0]=c:r[1]=c,this.props.dispatch(Object(s.g)({root:r,cladeSelected:t}))}},ae=function(e){if("hover"===this.state.selectedNode.event){if(function(e){e&&O(e,e.n.parent.shell.branchStroke,e.branchStroke)}(e),this.props.temporalConfidence.exists&&this.props.temporalConfidence.display&&!this.props.temporalConfidence.on)(1===e.that.params.orientation[0]?this.state.tree:this.state.treeToo).removeConfidence();this.setState({selectedNode:{}})}},se=function(e){if("hover"===this.state.selectedNode.event){var t=1===e.that.params.orientation[0]?this.state.tree:this.state.treeToo;this.state.selectedNode||t.svg.select(Object(h.c)("#tip",e.n.name)).attr("r",(function(e){return e.r})),this.setState({selectedNode:{}})}},ce=function(e){(1===e.node.that.params.orientation[0]?this.state.tree:this.state.treeToo).svg.select(Object(h.c)("#tip",e.node.n.name)).attr("r",(function(e){return e.r})),this.setState({selectedNode:{}}),"tip"===e.type&&this.props.dispatch(Object(s.a)("inactivate",f.M,[e.node.n.name]))},le=n(1157),ue=(n(841),function(e,t,n,r){var i=t?e.domRefs.mainTree:e.domRefs.secondTree,o=t?r.tree:r.treeToo;if(o.loaded){var a=r.canRenderBranchLabels;Object.prototype.hasOwnProperty.call(r.scatterVariables,"showBranches")&&!1===r.scatterVariables.showBranches&&(a=!1),n.render(Object(le.a)(i),r.layout,r.distanceMeasure,{grid:!0,confidence:r.temporalConfidence.display,branchLabelKey:a&&r.selectedBranchLabel,showAllBranchLabels:r.showAllBranchLabels,orientation:t?[1,1]:[-1,1],tipLabels:!0,showTipLabels:!0},{onTipHover:ne.bind(e),onTipClick:re.bind(e),onBranchHover:ie.bind(e),onBranchClick:oe.bind(e),onBranchLeave:ae.bind(e),onTipLeave:se.bind(e),tipLabel:C(r.tipLabelKey)},o.branchThickness,o.visibility,r.temporalConfidence.on,o.vaccines,Object(y.a)(o,r.colorByConfidence,r.colorBy),o.nodeColors,o.nodeColors.map(y.e),o.tipRadii,[r.dateMinNumeric,r.dateMaxNumeric],r.scatterVariables)}else console.warn("can't run renderTree (not loaded)")});function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return(t=ye(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ye(r.key),r)}}function ye(e){var t=function(e,t){if("object"!==pe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===pe(t)?t:String(t)}function be(e,t){return(be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=we(e);if(t){var i=we(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&be(e,t)}(a,e);var t,n,r,o=ge(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).state={left:0,top:31,lookup:void 0,drawn:!1},t.timeout=!1,t}return t=a,(n=[{key:"shouldComponentUpdate",value:function(e){return this.props.width!==e.width||this.props.height!==e.height||this.props.leftTreeName!==e.leftTreeName||this.props.rightTreeName!==e.rightTreeName}},{key:"drawLines",value:function(e){e||(e=this.props);var t=e.lookup.length>750?.25:e.lookup.length>100?.5:1;Object(le.a)(this.d3ref).selectAll("*").remove();var n=function(e){return function(t){var n=e.leftNodes[t[0]].shell,r=e.rightNodes[t[1]].shell;return"M ".concat(n.xTip,",").concat(n.yTip," H ").concat(e.width/2-e.spaceBetweenTrees/2," L ").concat(e.width/2+e.spaceBetweenTrees/2,",").concat(r.yTip," H ").concat(e.width/2+e.spaceBetweenTrees/2+r.xTip)}}(e);Object(le.a)(this.d3ref).selectAll(".tangleLine").data(e.lookup).enter().append("path").attr("class","tangleLine").attr("d",n).attr("stroke-width",t).attr("stroke",(function(t){return e.colors[t[0]]})).attr("fill","none")}},{key:"componentWillReceiveProps",value:function(e){!this.state.drawn&&e.rightNodes[0].shell&&(this.drawLines(e),this.setState({drawn:!0}))}},{key:"componentDidMount",value:function(){!this.state.drawn&&this.props.rightNodes[0].shell&&(this.drawLines(this.props),this.setState({drawn:!0}))}},{key:"componentDidUpdate",value:function(e){this.props.width===e.width&&this.props.height===e.height||(this.timeout?window.clearTimeout(this.timeout):Object(le.a)(this.d3ref).selectAll(".tangleLine").remove(),this.timeout=window.setTimeout(this.drawLines.bind(this),1e3))}},{key:"render",value:function(){var e=this,t={position:"absolute",top:5,zIndex:100,fontSize:16,color:"#000",fontWeight:500},n=[this.props.width/2-this.props.spaceBetweenTrees/2,this.props.width/2+this.props.spaceBetweenTrees/2];return i.a.createElement("div",{id:"TangleContainer"},i.a.createElement("div",{id:"MainTreeTitle",style:de(de({},t),{},{left:n[0],transform:"translateX(-100%)"})},this.props.leftTreeName),i.a.createElement("div",{id:"SecondTreeTitle",style:de(de({},t),{},{left:n[1]})},this.props.rightTreeName),i.a.createElement("div",{id:"TangleSvgContainer",style:{position:"absolute",left:this.state.left,top:this.state.top,zIndex:100,pointerEvents:"none"}},i.a.createElement("svg",{id:"Tangle",style:{cursor:"default",width:this.props.width,height:this.props.height},ref:function(t){e.d3ref=t}})))}}])&&me(t.prototype,n),r&&me(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a.Component),Se=n(848),xe=function(e,t){for(var n=0,r=0,i=0,o=0,a=0,s=0,c=0;c<t.nodes.length;c++){var l=t.nodes[c];if(!l.n.children&&e.strainToNode[l.n.name]){var u=e.strainToNode[l.n.name].displayOrder,p=l.displayOrder;n++,r+=u,i+=p,o+=Math.pow(u,2),a+=Math.pow(p,2),s+=u*p}}return o/=n,a/=n,((s/=n)-(r/=n)*(i/=n))/Math.sqrt((o-Math.pow(r,2))*(a-Math.pow(i,2)))},je=function(e,t){!function(e,t){for(var n=xe(e,t),r=0;r<t.nodes.length;r++){var i=t.nodes[r],o=i.n;if(o.children){for(var a=o,s=function(){var e=a.children[0];a.children.forEach((function(t){t.shell.displayOrder<e.shell.displayOrder&&(e=t)})),a=e};a.hasChildren;)s();var c=a.shell.displayOrder-1;o.children.reverse(),Object(h.i)(i,c);var l=xe(e,t);n>l?(o.children.reverse(),Object(h.i)(i,c)):n=l}}}(e,t),Object(h.h)(t.nodes)};function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Me(r.key),r)}}function Ie(e,t){return(Ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ae(e);if(t){var i=Ae(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _e(this,n)}}function _e(e,t){if(t&&("object"===Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Be(e)}function Be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e,t,n){return(t=Me(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Me(e){var t=function(e,t){if("object"!==Ee(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ee(t)?t:String(t)}var De=100,Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ie(e,t)}(p,e);var t,n,r,o=Ne(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),Re(Be(t=o.call(this,e)),"getStyles",(function(){var e=0!==t.props.tree.idxOfInViewRootNode||0!==t.props.treeToo.idxOfInViewRootNode,n=!!t.props.tree.idxOfFilteredRoot&&t.props.tree.idxOfInViewRootNode!==t.props.tree.idxOfFilteredRoot,r=!!t.props.treeToo.idxOfFilteredRoot&&t.props.treeToo.idxOfInViewRootNode!==t.props.treeToo.idxOfFilteredRoot,i=n||r,o=0!==t.props.tree.idxOfInViewRootNode||0!==t.props.treeToo.idxOfInViewRootNode;return{treeButtonsDiv:{zIndex:100,position:"absolute",right:5,top:0},resetTreeButton:{zIndex:100,display:"inline-block",marginLeft:4,cursor:e?"pointer":"auto",color:e?u.a:u.f},zoomToSelectedButton:{zIndex:100,display:"inline-block",cursor:i?"pointer":"auto",color:i?u.a:u.f,pointerEvents:i?"auto":"none"},zoomOutButton:{zIndex:100,display:"inline-block",cursor:o?"pointer":"auto",color:o?u.a:u.f,pointerEvents:o?"auto":"none",marginRight:"4px"}}})),Re(Be(t),"zoomToSelected",(function(){t.props.dispatch(Object(s.g)({root:[t.props.tree.idxOfFilteredRoot,t.props.treeToo.idxOfFilteredRoot]}))})),Re(Be(t),"zoomBack",(function(){var e,n;if(0!==t.props.tree.idxOfInViewRootNode){var r=t.props.tree.nodes[t.props.tree.idxOfInViewRootNode];e=Object(h.e)(r,t.props.distanceMeasure,t.props.tree.observedMutations).arrayIdx}if(0!==t.props.treeToo.idxOfInViewRootNode){var i=t.props.treeToo.nodes[t.props.treeToo.idxOfInViewRootNode];n=Object(h.e)(i,t.props.distanceMeasure,t.props.treeToo.observedMutations).arrayIdx}var o=[e,n];t.props.dispatch(Object(s.g)({root:o}))})),t.domRefs={mainTree:void 0,secondTree:void 0},t.tangleRef=void 0,t.state={selectedNode:{},tree:null,treeToo:null},t.clearSelectedNode=ce.bind(Be(t)),t.redrawTree=function(){t.props.dispatch(Object(s.g)({root:[0,0]}))},t.handlekeydownEvent=function(e){var n;"Escape"===e.key&&null!==(n=t.state.selectedNode)&&void 0!==n&&n.node&&t.clearSelectedNode(t.state.selectedNode)},t}return t=p,(n=[{key:"setUpAndRenderTreeToo",value:function(e,t){t.treeToo=new Z(e.treeToo.nodes,"RIGHT",e.treeToo.idxOfInViewRootNode),f.g&&je(t.tree,t.treeToo),ue(this,!1,t.treeToo,e)}},{key:"componentDidMount",value:function(){if(document.addEventListener("keyup",this.handlekeydownEvent),this.props.tree.loaded){var e={};e.tree=new Z(this.props.tree.nodes,"LEFT",this.props.tree.idxOfInViewRootNode),ue(this,!0,e.tree,this.props),this.props.showTreeToo&&this.setUpAndRenderTreeToo(this.props,e),e.geneSortFn=Object(j.k)(this.props.metadata.genomeAnnotations),this.setState(e)}}},{key:"componentDidUpdate",value:function(e){var t={},n=!1,r=Ce(te(!0,this.state.tree,e,this.props),2),i=r[0],o=r[1];if(i&&(t=i),e.showTreeToo!==this.props.showTreeToo)this.props.showTreeToo?(this.state.treeToo&&this.state.treeToo.clearSVG(),t.tree=this.state.tree,this.setUpAndRenderTreeToo(this.props,t),this.tangleRef&&this.tangleRef.drawLines()):t.treeToo=null;else if(this.state.treeToo){var a=Ce(te(!1,this.state.treeToo,e,this.props),2);a[0],n=a[1]}this.tangleRef&&(o||n)&&this.tangleRef.drawLines(),Object.keys(t).length&&this.setState(t)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.handlekeydownEvent)}},{key:"renderTreeDiv",value:function(e){var t=this,n=e.width,r=e.height,o=e.mainTree;return i.a.createElement("svg",{id:o?"MainTree":"SecondTree",style:{pointerEvents:"auto",cursor:"default",userSelect:"none"},width:n,height:r,ref:function(e){o?t.domRefs.mainTree=e:t.domRefs.secondTree=e}})}},{key:"render",value:function(){var e=this,t=this.props.t,n=this.getStyles(),r=this.props.showTreeToo?(this.props.width-De)/2:this.props.width;return i.a.createElement(c.a,{center:!0,title:t("Phylogeny")},i.a.createElement(Se.a,null,i.a.createElement(l.a,{width:this.props.width})),i.a.createElement(Q.b,{selectedNode:this.state.selectedNode,colorBy:this.props.colorBy,colorByConfidence:this.props.colorByConfidence,colorScale:this.props.colorScale,colorings:this.props.metadata.colorings,geneSortFn:this.state.geneSortFn,observedMutations:this.props.tree.observedMutations,panelDims:{width:this.props.width,height:this.props.height,spaceBetweenTrees:De},t:t}),i.a.createElement(ee.a,{clearSelectedNode:this.clearSelectedNode,selectedNode:this.state.selectedNode,observedMutations:this.props.tree.observedMutations,colorings:this.props.metadata.colorings,geneSortFn:this.state.geneSortFn,t:t}),this.props.showTangle&&this.state.tree&&this.state.treeToo?i.a.createElement(Oe,{ref:function(t){e.tangleRef=t},width:this.props.width,height:this.props.height,lookup:this.props.treeToo.tangleTipLookup,leftNodes:this.props.tree.nodes,rightNodes:this.props.treeToo.nodes,colors:this.props.tree.nodeColors,cVersion:this.props.tree.nodeColorsVersion,vVersion:this.props.tree.visibilityVersion,metric:this.props.distanceMeasure,spaceBetweenTrees:De,leftTreeName:this.props.tree.name,rightTreeName:this.props.showTreeToo}):null,this.renderTreeDiv({width:r,height:this.props.height,mainTree:!0}),this.props.showTreeToo?i.a.createElement("div",{id:"treeSpacer",style:{width:De}}):null,this.props.showTreeToo?this.renderTreeDiv({width:r,height:this.props.height,mainTree:!1}):null,this.props.narrativeMode?null:i.a.createElement("div",{style:Te({},n.treeButtonsDiv)},i.a.createElement("button",{style:Te(Te({},u.n),n.zoomOutButton),onClick:this.zoomBack},i.a.createElement(a.n,null)),i.a.createElement("button",{style:Te(Te({},u.n),n.zoomToSelectedButton),onClick:this.zoomToSelected},t("Zoom to Selected")),i.a.createElement("button",{style:Te(Te({},u.n),n.resetTreeButton),onClick:this.redrawTree},t("Reset Layout"))))}}])&&Le(t.prototype,n),r&&Le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),p}(i.a.Component),Fe=Object(o.a)()(Ve);t.a=Fe},924:function(e,t,n){"use strict";n.d(t,"b",(function(){return ie}));var r=n(1),i=n.n(r),o=n(880),a=n.n(o),s=n(796),c=n(817),l=n(819),u=n(822),p=n(956),h=n(925),d=n(858),f=n(797),m=n(867),y=n(818),b=n(837),g=n(922),v=n(823),w=n(832),O=n(828),S=n(901);function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||E(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=E(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function E(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var T=function(e){return Object.prototype.hasOwnProperty.call(e,"paper_url")&&!e.paper_url.endsWith("/")&&"?"!==e.paper_url},C=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return""},i=t?function(e){return Object(v.h)(e,"num_date")}:v.e;function o(t,a){if(!t.inView||e.visibility[t.arrayIdx]!==y.b)return"";if(t.hasChildren){var s=t.children.map((function(e){return o(e,i(t))}));return"(".concat(s.filter((function(e){return!!e})).join(","),")")+"".concat(n?t.name:"").concat(r(t),":").concat(i(t)-a)}return"".concat(t.name).concat(r(t),":").concat(i(t)-a)}var a=e.nodes[e.idxOfFilteredRoot||e.idxOfInViewRootNode],s=i(a),c=o(a,s);if(!c)throw new S.a;return c+";"},P="text/plain;charset=utf-8;",L="text/tab-separated-values;charset=utf-8;",I="image/svg+xml;charset=utf-8",N=function(e,t,n){var r=new Blob([n],{type:t}),i=document.createElement("a"),o=URL.createObjectURL(r);i.setAttribute("href",o),i.setAttribute("download",e),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)},_=function(e){var t=e.dispatch,n=e.filePrefix,r=e.tree,i=e.isNewick,o=e.temporal,a=e.colorings,s=e.colorBy;try{var c="".concat(n,"_").concat(o?"timetree":"tree",".").concat(i?"nwk":"nexus"),l=i?C(r,o):function(e,t,n,r){var i,o;return["#nexus","begin trees;","  tree one = "+C(e,r,!0,(i=function(e){return String(e).replace(/[[\]{}=,]/g,"").replace(/[\u0250-\ue007]/g,"")},o=Object(O.f)(n)?i(n.replace(/,/g,"/")):void 0,function(e){var n=[];if(Object.keys(t).forEach((function(t){if(!t.includes("_lab")&&!t.includes("author")){var r=Object(v.h)(e,t);if(r){n.push("".concat(i(t),"=").concat(i(r)));var o=Object(v.h)(e,t,{confidence:!0});Array.isArray(o)&&2===o.length&&n.push("".concat(i(t),"_CI={").concat(o.map((function(e){return i(e)})).join(","),"}"))}}})),o&&n.push("".concat(o,"=").concat(i(e.currentGt.replace(/\s/g,"")))),r){var a=Object(v.e)(e);void 0!==a&&n.push("div=".concat(a))}return n.length?"[&".concat(n.join(","),"]"):""})),"end;"].join("\n")}(r,a,s,o);N(c,P,l),t(Object(b.b)({message:"".concat(o?"TimeTree":"Tree"," written to ").concat(c)}))}catch(e){console.error(e);var u={message:"Error saving tree!"};e instanceof S.a&&(u.details="An empty tree was created. If you have selected genomes, note that we do not support downloads of multiple subtrees."),t(Object(b.d)(u))}},B=function(e){var t=e.match(/^(<.+?>)(.+)<\/.+?>$/);if(t){var n=t[1].match(/width.+?([0-9.]+).+height.+?([0-9.]+)/);if(n){var r=t[1].match(/viewBox="([0-9-]+)\s([0-9-]+)\s([0-9-]+)\s([0-9-]+)"/);return{x:0,y:0,viewbox:r?r.slice(1):void 0,width:parseFloat(n[1]),height:parseFloat(n[2]),inner:t[2]}}}},A=function(e,t,n){var r='<svg id="'.concat(t,'" width="').concat(n.width,'" height="').concat(n.height,'" x="').concat(n.x,'" y="').concat(n.y,'">');e.push(r),e.push(n.inner),e.push("</svg>")},R=function(e,t,n,r,i,o){var a=[],s={tree:void 0,map:void 0,entropy:void 0,frequencies:void 0};if(-1!==n.indexOf("tree")){try{s.tree=B((new XMLSerializer).serializeToString(document.getElementById("MainTree"))),s.treeLegend=B((new XMLSerializer).serializeToString(document.getElementById("TreeLegendContainer")))}catch(e){s.tree=void 0,a.push("tree"),console.error("Tree SVG save error:",e)}if(s.tree&&document.getElementById("SecondTree"))try{s.secondTree=B((new XMLSerializer).serializeToString(document.getElementById("SecondTree"))),document.getElementById("Tangle")&&(s.tangle=B((new XMLSerializer).serializeToString(document.getElementById("Tangle"))))}catch(e){a.push("second tree / tanglegram"),console.error("Second Tree / tanglegram SVG save error:",e)}}if(-1!==n.indexOf("entropy"))try{s.entropy=B((new XMLSerializer).serializeToString(document.getElementById("d3entropyParent"))),s.entropy.inner=s.entropy.inner.replace(/<text/g,'<text class="txt"'),s.entropy.inner='<style>.txt { font-family: "Lato", "Helvetica Neue", "Helvetica", "sans-serif"; }</style>'.concat(s.entropy.inner)}catch(e){s.entropy=void 0,a.push("entropy"),console.error("Entropy SVG save error:",e)}if(-1!==n.indexOf("frequencies"))try{s.frequencies=B((new XMLSerializer).serializeToString(document.getElementById("d3frequenciesSVG")))}catch(e){s.frequencies=void 0,a.push("frequencies"),console.error("Frequencies SVG save error:",e)}-1!==n.indexOf("map")&&o&&(s.map={x:0,y:0,viewbox:void 0,width:parseFloat(o.mapDimensions.x),height:parseFloat(o.mapDimensions.y),inner:o.mapSvg});var c=[],l=function(e,t,n){var r=0,i=0;for(var o in e.secondTree&&(e.secondTree.x=g.b+e.tree.width,e.tree.width+=g.b+e.secondTree.width),e.tree&&e.map?"grid"===t?(r=e.tree.width+50+e.map.width,i=Math.max(e.tree.height,e.map.height),e.map.x=e.tree.width+50):(r=Math.max(e.tree.width,e.map.width),i=e.tree.height+50+e.map.height,e.map.y=e.tree.height+50):e.tree?(r=e.tree.width,i=e.tree.height):e.map&&(r=e.map.width,i=e.map.height),e.entropy&&(r<e.entropy.width?r=e.entropy.width:e.entropy.x=(r-e.entropy.width)/2,i?(e.entropy.y=i+50,i+=50+e.entropy.height):i=e.entropy.height),e.frequencies&&(r<e.frequencies.width?r=e.frequencies.width:e.frequencies.x=(r-e.frequencies.width)/2,i?(e.frequencies.y=i+50,i+=50+e.frequencies.height):i=e.frequencies.height),e)e[o]&&(e[o].x+=50,e[o].y+=50);i+=100;var a=36*n+20;return{width:r+=100,height:i+=a,padding:50,textY:i-a,textHeight:a}}(s,r,i.length);for(var u in c.push('<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="'.concat(l.width,'" height="').concat(l.height,'">')),s)s[u]&&A(c,u,s[u]);c.push('<foreignObject x="'.concat(l.padding,'" y="').concat(l.height-l.textHeight,'" height="').concat(l.textHeight,'" width="').concat(l.width-2*l.padding,'">')),i.forEach((function(e){c.push('<p xmlns="http://www.w3.org/1999/xhtml" style="font-family:lato,sans-serif;">'),c.push(e),c.push("</p>")})),c.push("</foreignObject>"),c.push("</svg>"),N(t+".svg",I,c.join("\n")),a.length?e(Object(b.d)({message:"Vector image saved",details:"Saved to ".concat(t,".svg, however there were errors with ").concat(a.join(", "))})):e(Object(b.b)({message:"Vector image saved",details:t+".svg"}))},M=n(852);function D(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var F,G=Object(f.d)(m.f),W=Object(f.d)(m.d),z=Object(f.d)(m.b),q=function(e){var t,n,r,o=e.dispatch,a=e.t,s=e.tree,c=e.entropy,l=e.metadata,u=e.colorBy,p=e.mutType,h=e.distanceMeasure,f=e.panelsToDisplay,m=e.panelLayout,g=e.filters,O=e.visibility,S=e.visibleStateCounts,E=e.relevantPublications,k=l.mainTreeNumTips,C=Object(M.d)(s.nodes,s.visibility),P=C!==k,I=U(),B="num_date"===h,A=!1;if("dataProvenance"in l){var V,F=D(l.dataProvenance);try{for(F.s();!(V=F.n()).done;){var q=V.value;"name"in q&&"GISAID"===q.name.toUpperCase()&&(A=!0)}}catch(e){F.e(e)}finally{F.f()}}return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{fontWeight:500,marginTop:"0px",marginBottom:"20px"}},"Downloaded data represents the currently displayed view. By zooming the tree, changing the branch-length metric, applying filters etc, the downloaded data will change accordingly.",i.a.createElement("p",null),"NOTE: We do not support downloads of multiple subtrees, which are usually created with the date range filter or genotype filters. Downloading multiple subtrees will result in an empty Newick tree!",i.a.createElement("p",null),P?"Currently ".concat(C,"/").concat(k," tips are displayed and will be downloaded."):"Currently the entire dataset (".concat(k," tips) will be downloaded.")),i.a.createElement(H,{name:"".concat(B?"TimeTree":"Tree"," (Newick)"),description:"Phylogenetic tree in Newick format with branch lengths in units of ".concat(B?"years":"divergence","."),icon:i.a.createElement(G,{width:25,selected:!0}),onClick:function(){return _({isNewick:!0,dispatch:o,filePrefix:I,tree:s,temporal:B})}}),i.a.createElement(H,{name:"".concat(B?"TimeTree":"Tree"," (Nexus)"),description:"Phylogeny in Nexus format with branch lengths in units of ".concat(B?"years":"divergence",". Colorings are included as annotations."),icon:i.a.createElement(G,{width:25,selected:!0}),onClick:function(){return _({dispatch:o,filePrefix:I,tree:s,colorings:l.colorings,colorBy:u,temporal:B})}}),A&&i.a.createElement(H,{name:"Acknowledgments (TSV)",description:"Per-sample acknowledgments (n = ".concat(C,")."),icon:i.a.createElement(z,{width:25,selected:!0}),onClick:function(){return function(e,t,n,r,i){var o,a={},s=["strain"],c=j(n.entries());try{for(c.s();!(o=c.n()).done;){var l=x(o.value,2),u=l[0],p=l[1];if(!p.hasChildren&&(i[u]===y.b&&p.inView&&(a[p.name]={strain:p.name},p.node_attrs))){for(var h=0,d=["gisaid_epi_isl","genbank_accession","originating_lab","submitting_lab"];h<d.length;h++){var f=d[h],m=Object(v.h)(p,f);m&&(s.includes(f)||s.push(f),a[p.name][f]=m)}var g=Object(v.f)(p);if(g){s.includes("author")||s.push("author"),a[p.name].author=g.value,T(g)&&(a[p.name].author+=" (".concat(g.paper_url,")"))}}}}catch(e){c.e(e)}finally{c.f()}for(var w=[s.join("\t")],O=0,S=Object.values(a);O<S.length;O++){var E,k=S[O],C=[],P=j(s);try{for(P.s();!(E=P.n()).done;){var I=E.value;C.push(k[I]||"")}}catch(e){P.e(e)}finally{P.f()}w.push(C.join("\t"))}var _="".concat(t,"_acknowledgements.tsv");N(_,L,w.join("\n")),e(Object(b.b)({message:"Acknowledgments exported to ".concat(_)}))}(o,I,s.nodes,l.colorings,s.visibility)}}),!A&&i.a.createElement(H,{name:"Metadata (TSV)",description:"Per-sample metadata (n = ".concat(C,")."),icon:i.a.createElement(z,{width:25,selected:!0}),onClick:function(){return function(e,t,n,r,i){var o,a={},s=["strain"],c=j(n.entries());try{var l=function(){var e=x(o.value,2),t=e[0],n=e[1];if(n.hasChildren)return"continue";if(i[t]!==y.b||!n.inView)return"continue";if(a[n.name]={strain:n.name},!n.node_attrs)return"continue";var r=Object(v.h)(n,"num_date");if(r){s.includes("date")||s.push("date");var c=Object(v.h)(n,"num_date",{confidence:!0});c&&c[0]!==c[1]?a[n.name].date="".concat(Object(w.g)(r)," (").concat(Object(w.g)(c[0])," - ").concat(Object(w.g)(c[1]),")"):a[n.name].date=Object(w.g)(r)}var l,u=["author","div","num_date","vaccine","accession"],p=j(Object.keys(n.node_attrs).filter((function(e){return!u.includes(e)})));try{for(p.s();!(l=p.n()).done;){var h=l.value;s.includes(h)||s.push(h);var d=Object(v.h)(n,h);d&&("string"==typeof d?a[n.name][h]=d:"number"==typeof d&&(a[n.name][h]=parseFloat(d).toFixed(2)))}}catch(e){p.e(e)}finally{p.f()}var f=Object(v.f)(n);if(f){s.includes("author")||s.push("author"),a[n.name].author=f.value,T(f)&&(a[n.name].author+=" (".concat(f.paper_url,")"))}var m=Object(v.j)(n);if(m&&m.selection_date){var b="vaccine_selection_date";s.includes(b)||s.push(b),a[n.name][b]=m.selection_date}var g=Object(v.c)(n);if("accession"in g){s.includes("accession")||s.push("accession"),a[n.name].accession=g.accession}};for(c.s();!(o=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}for(var u=[s.join("\t")],p=0,h=Object.values(a);p<h.length;p++){var d,f=h[p],m=[],g=j(s);try{for(g.s();!(d=g.n()).done;){var O=d.value;m.push(f[O]||"")}}catch(e){g.e(e)}finally{g.f()}u.push(m.join("\t"))}var S="".concat(t,"_metadata.tsv");N(S,L,u.join("\n")),e(Object(b.b)({message:"Metadata exported to ".concat(S)}))}(o,I,s.nodes,l.colorings,s.visibility)}}),function(e){for(var t=0;t<e.nodes.length;t++)if(Object(v.f)(e.nodes[t]))return!0;return!1}(s)&&i.a.createElement(H,{name:"Author Metadata (TSV)",description:"Metadata for ".concat(C," samples grouped by their ").concat((t=s.nodes,n=s.visibility,r=new Set(t.filter((function(e,t){return n[t]===y.b&&e.inView})).map((function(e){return Object(v.f)(e)})).filter((function(e){return e&&e.value})).map((function(e){return e.value}))),r.size)," authors."),icon:i.a.createElement(z,{width:25,selected:!0}),onClick:function(){return function(e,t,n){var r=[];r.push(["Author","n (strains)","publication title","journal","publication URL","strains"].join("\t"));var i=t+"_authors.tsv",o={};n.nodes.filter((function(e,t){return n.visibility[t]===y.b&&e.inView})).filter((function(e){return!e.hasChildren})).forEach((function(e){var t=Object(v.f)(e);t&&(o[t.value]?(o[t.value].count+=1,o[t.value].strains.push(e.name)):o[t.value]={author:t.value,title:t.title||"unknown",journal:t.journal||"unknown",url:T(t)?t.paper_url:"unknown",count:1,strains:[e.name]})})),Object.values(o).forEach((function(e){r.push([e.author,e.count,e.title,e.journal,e.url,e.strains.join(",")].join("\t"))})),N(i,L,r.join("\n")),e(Object(b.b)({message:"Author metadata exported",details:i}))}(o,I,s)}}),c.loaded&&i.a.createElement(H,{name:"Genetic diversity data (TSV)",description:"The data behind the diversity panel showing ".concat(c.showCounts?"a count of changes across the tree":"normalised shannon entropy"," per ").concat("nuc"===p?"nucleotide":"codon","."),icon:i.a.createElement(z,{width:25,selected:!0}),onClick:function(){return function(e,t,n,r){var i="nuc"===r?["base"]:["gene\tposition"];i[0]+=n.showCounts?"\tevents":"\tentropy",n.bars.forEach((function(e){"nuc"===r?i.push("".concat(e.x,"\t").concat(e.y)):i.push("".concat(e.prot,"\t").concat(e.codon,"\t").concat(e.y))}));var o="".concat(t,"_diversity.tsv");N(o,L,i.join("\n")),e(Object(b.b)({message:"Diversity data exported to ".concat(o)}))}(o,I,c,p)}}),i.a.createElement(H,{name:"Screenshot (SVG)",description:"Screenshot of the current nextstrain display in SVG format; CC-BY licensed.",icon:i.a.createElement(W,{width:25,selected:!0}),onClick:function(){return function(e,t,n,r,i,o,a,s,c,l,u){var p=[];p.push(n.title),p.push("Last updated ".concat(n.updated));var h=window.location.href.replace(/&/g,"&amp;");p.push('Downloaded from <a href="'.concat(h,'">').concat(h,"</a> on ").concat((new Date).toLocaleString())),p.push(Object(d.a)({mainTreeNumTips:n.mainTreeNumTips,nodes:r,filters:i,visibility:o,visibleStateCounts:a,t:t})),p.push(""),p.push("".concat(t("Data usage part 1"),' A full list of sequence authors is available via <a href="https://nextstrain.org">nextstrain.org</a>.')),p.push("Visualizations are licensed under CC-BY."),p.push("Relevant publications:"),u.forEach((function(e){p.push('<a href="'.concat(e.href,'">').concat(e.author,", ").concat(e.title,", ").concat(e.journal," (").concat(e.year,")</a>"))})),-1!==c.indexOf("map")?window.L.getMapSvg(R.bind(void 0,e,s,c,l,p)):R(e,s,c,l,p,void 0)}(o,a,l,s.nodes,g,O,S,U(),f,m,E)}}))};function H(e){var t=e.name,n=e.description,r=e.icon,o=e.onClick,a=Object.assign({},u.g,{backgroundColor:"rgba(0,0,0,0)",paddingLeft:"10px",color:"white",minWidth:"300px",textAlign:"left"});return i.a.createElement("div",{key:t,onClick:o,style:{cursor:"pointer"}},r,i.a.createElement("button",{style:a,name:t},t),i.a.createElement("div",{style:{display:"inline-block",height:"30px",verticalAlign:"top",paddingTop:"6px"}},i.a.createElement("label",{style:{fontStyle:"italic",fontSize:"14px",color:"lightgray"},htmlFor:t},n)))}function U(){return"nextstrain_"+window.location.pathname.replace(/^\//,"").replace(/:/g,"-").replace(/\//g,"_")}function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(){return(Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e,t,n){return(t=Z(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Z(r.key),r)}}function Z(e){var t=function(e,t){if("object"!==K(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===K(t)?t:String(t)}function Q(e,t){return(Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=re(e);if(t){var i=re(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return te(this,n)}}function te(e,t){if(t&&("object"===K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ne(e)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e){return(re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ie={nextstrain:{author:"Hadfield et al",title:"Nextstrain: real-time tracking of pathogen evolution",year:"2018",journal:"Bioinformatics",href:"https://doi.org/10.1093/bioinformatics/bty407"},treetime:{author:"Sagulenko et al",title:"TreeTime: Maximum-likelihood phylodynamic analysis",journal:"Virus Evolution",year:"2017",href:"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5758920/"},titers:{author:"Neher et al",titleJournalYear:"Prediction, dynamics, and visualization of antigenic phenotypes of seasonal influenza viruses",journal:"PNAS",year:"2016",href:"http://www.pnas.org/content/113/12/E1701.abstract"}},oe=Object(s.b)((function(e){return{browserDimensions:e.browserDimensions.browserDimensions,show:e.controls.showDownload,colorBy:e.controls.colorBy,distanceMeasure:e.controls.distanceMeasure,metadata:e.metadata,entropy:e.entropy,mutType:e.controls.mutType,tree:e.tree,nodes:e.tree.nodes,visibleStateCounts:e.tree.visibleStateCounts,filters:e.controls.filters,visibility:e.tree.visibility,panelsToDisplay:e.controls.panelsToDisplay,panelLayout:e.controls.panelLayout}}))(F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(s,e);var t,n,r,o=ee(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).getStyles=function(e,t){return{behind:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"all",zIndex:2e3,backgroundColor:"rgba(80, 80, 80, .20)",display:"flex",justifyContent:"center",alignItems:"center",wordWrap:"break-word",wordBreak:"break-word"},title:{fontWeight:500,fontSize:32,marginTop:"20px",marginBottom:"20px"},secondTitle:{fontWeight:500,marginTop:"0px",marginBottom:"20px"},modal:{marginLeft:200,marginTop:130,width:e-400,height:t-260,borderRadius:2,backgroundColor:"rgba(250, 250, 250, 1)",overflowY:"auto"},break:{marginBottom:"10px"}}},t.dismissModal=t.dismissModal.bind(ne(t)),t}return t=s,(n=[{key:"componentDidMount",value:function(){var e=this;a.a.bind("d",(function(){e.props.dispatch({type:e.props.show?l.B:l.db})}))}},{key:"getRelevantPublications",value:function(){var e=[ie.nextstrain,ie.treetime];return-1!==["cTiter","rb","ep","ne"].indexOf(this.props.colorBy)&&e.push(ie.titers),e}},{key:"formatPublications",value:function(e){return i.a.createElement("span",null,i.a.createElement("ul",null,e.map((function(e){return i.a.createElement("li",{key:e.href},i.a.createElement("a",{href:e.href,target:"_blank",rel:"noreferrer noopener"},e.author,", ",e.title,", ",i.a.createElement("i",null,e.journal)," (",e.year,")"))}))))}},{key:"dismissModal",value:function(){this.props.dispatch({type:l.B})}},{key:"render",value:function(){var e=this.props.t;if(!this.props.show)return null;var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){X(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},u.e.panel);t.width=.66*this.props.browserDimensions.width,t.maxWidth=t.width,t.maxHeight=.66*this.props.browserDimensions.height,t.fontSize=14,t.lineHeight=1.4;var n=this.getRelevantPublications(),r=this.props.metadata;return i.a.createElement("div",{style:u.e.modalContainer,onClick:this.dismissModal},i.a.createElement("div",{style:t,onClick:function(e){return Object(p.b)(e)}},i.a.createElement("p",{style:u.e.topRightMessage},"(",e("click outside this box to return to the app"),")"),i.a.createElement("div",{style:u.e.modalSubheading},r.title," (",e("last updated")," ",r.updated,")"),i.a.createElement("div",null,Object(d.a)({mainTreeNumTips:this.props.metadata.mainTreeNumTips,nodes:this.props.nodes,filters:this.props.filters,visibility:this.props.visibility,visibleStateCounts:this.props.visibleStateCounts,t:this.props.t})),i.a.createElement("div",{style:u.e.break})," "+e("A full list of sequence authors is available via the TSV files below"),i.a.createElement("div",{style:u.e.break}),Object(h.b)({},{preamble:{fontWeight:300},acknowledgments:{fontWeight:300}}),i.a.createElement("div",{style:u.e.modalSubheading},e("Data usage policy")),e("Data usage part 1")+" "+e("Data usage part 2"),i.a.createElement("div",{style:u.e.modalSubheading},e("Please cite the authors who contributed genomic data (where relevant), as well as")+":"),this.formatPublications(n),i.a.createElement("div",{style:u.e.modalSubheading},e("Download data"),":"),i.a.createElement("div",{style:{display:"block",justifyContent:"space-around",marginLeft:"25px",width:"100%"}},i.a.createElement("div",{style:{width:"100%"}},i.a.createElement(q,Y({},this.props,{relevantPublications:n}))))))}}])&&$(t.prototype,n),r&&$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(i.a.Component))||F,ae=Object(c.a)()(oe);t.a=ae},925:function(e,t,n){"use strict";n.d(t,"b",(function(){return I}));var r=n(1),i=n.n(r),o=n(796),a=n(797),s=n(1121),c=n.n(s),l=n(817),u=n(827),p=n(822),h=n(849),d=n(825),f=n(818),m=n(865),y=n(828);function b(e,t){if(window.location.pathname.includes("inrb-drc"))return i.a.createElement("div",null,i.a.createElement("div",null,"This work is made possible by the open sharing of genetic data by research groups."),i.a.createElement("div",{className:"acknowledgments"},"These sequences were generated by the Democratic Republic of the Congo Sequencing Consortium led by the Institut National de Recherche Biomédicales (INRB), Kinshasa, DRC, partnered with the United States Army Medical Reseach Insititute of Infectious Diseases (USAMRIID), Maryland, USA; University of Nebraska Medical Center (UNMC), Nebraska, USA; Institut Pasteur de Dakar, Dakar, Senegal; TransVIHMI, Institut de Recherche pour le Développement (IRD), Institut National de la Santé et de la Recherche Médicale (INSERM), Université de Montpellier, Montpellier, France."),i.a.createElement("div",{className:"acknowledgments"},"These data were shared with the Ministry of Health of the DRC, and with the public via this ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://virological.org/t/drc-2018-viral-genome-characterization/230"},"virological.org")," post, which is continually updated. If you intend to use these sequences prior to publication, please contact Drs. Muyembe-Tamfum and Ahuka to coordinate."));if(!window.location.pathname.includes("community")){if(window.location.pathname.includes("ebola"))return function(e){return i.a.createElement("div",null,e,i.a.createElement("div",{className:"acknowledgments"},"Special thanks to Nick Loman, Matt Cotten, Ian Goodfellow and Paul Kellam for spearheading data sharing efforts during the outbreak. For a more complete phylogeographic analysis of these data see ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://dx.doi.org/10.1038/nature22040"},"Dudas et al"),". Curated data used in the paper are available at ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://github.com/ebov/space-time"},"github.com/ebov/space-time"),". The animation shown here was inspired by ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://youtu.be/eWnIhWUpQiQ"},"a work")," by ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://bedford.io/team/gytis-dudas/"},"Gytis Dudas"),"."))}(t);if(window.location.pathname.includes("zika"))return function(e){return i.a.createElement("div",null,e,i.a.createElement("div",{className:"acknowledgments"},"Special thanks to Nick Loman, Nathan Grubaugh, Kristof Theys, Nuno Faria, Kristian Andersen, Andrew Rambaut and Karl Erlandson for data sharing, comments and suggestions."))}(t);if(window.location.pathname.includes("mumps"))return function(e){return i.a.createElement("div",null,e,i.a.createElement("div",{className:"acknowledgments"},"Special thanks to Duah Alkam, Piroon Jenjaroenpun , Thidathip Wongsurawat, Zulema Udaondo, Preecha Patumcharoenpol, Michael Robeson, Dirk Haselow, William Mason, Intawat Nookaew, David Ussery, Se-Ran Jun, Jennifer Gardy, Shirlee Wohl, Jeff Joy, Patrick Stapleton, Nathan Yozwiak, Hayden Metsky, Agatha Jassem, Louise Moncla, Gytis Dudas and Pardis Sabeti for data sharing, comments and suggestions."))}(t);if(window.location.pathname.includes("lassa"))return function(e){return i.a.createElement("div",{className:"acknowledgments"},"This work is made possible by the open sharing of genetic data by research groups, including these groups currently collecting Lassa sequences:",i.a.createElement("p",null),i.a.createElement("a",{href:"http://acegid.org/"},"Christian Happi"),", ",i.a.createElement("a",{href:"https://www.sabetilab.org/"},"Pardis Sabeti"),", ",i.a.createElement("a",{href:"https://www.sabetilab.org/katherine-siddle/"},"Katherine Siddle")," and colleagues, whose data was shared via ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://virological.org/t/new-lassa-virus-genomes-from-nigeria-2015-2016/191"},"this viroligical.org post. "),"If you intend to use these sequences prior to publication, please contact them directly to coordinate. ",i.a.createElement("span",{className:"link",onClick:function(){return e(Object(d.a)("set","authors",["Odia_et_al"]))}},"Click here")," here to see these sequences in isolation.",i.a.createElement("p",null),"The Irrua specialist Teaching Hospital (ISTH) and Institute for Lassa Fever Research and Control (ILFRC), Irrua, Edo State, Nigeria;\n        The Bernhard-Nocht Institute for Tropical Medicine (BNITM), Hamburg, Germany;\n        Public Health England (PHE);\n        African Center of Excellence for Genomics of Infectious Disease (ACEGID ), Redeemer’s University, Ede, Nigeria;\n        Broad Institute of MIT and Harvard University (Cambridge, MA, USA).\n        For further details, including conditions of reuse, please contact ",i.a.createElement("a",{href:"mailto:epogbaini@yahoo.com"},"Ephraim Epogbaini"),", ",i.a.createElement("a",{href:"http://www.who.int/blueprint/about/stephan-gunther/en/"},"Stephan Günther")," and ",i.a.createElement("a",{href:"https://rega.kuleuven.be/cev/ecv/lab-members/PhilippeLemey.html"},"Philippe Lemey"),". Their data was first shared via ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://virological.org/t/2018-lasv-sequencing-continued/192/8"},"this viroligical.org post"),", which is continually updated. ",i.a.createElement("span",{className:"link",onClick:function(){return e(Object(d.a)("set","authors",["ISTH-BNITM-PHE"]))}},"Click here")," here to see these sequences in isolation.")}(e);if(window.location.pathname.includes("WNV/NA"))return function(e){return i.a.createElement("div",{className:"acknowledgments"},"This work is possible due to the groups who have made their data openly available for analysis -\n        with a special thanks to Nikos Gurfield, Saran Grewal, Chris Barker, Ying Fang and the Andersen Lab for making ",i.a.createElement("a",{href:"https://andersen-lab.com/secrets/data/west-nile-genomics/"},"their data")," available ahead of publication. ","We also thank Simon Dellicour, Sebastian Lequime, Bram Vrancken, Philippe Lemey, Karthik Gangavarapu, Nate Matteson, Sharada Saraf\n        and Nathan Grubaugh for curating the original dataset; and Zhe Zheng and Anderson Brito helping with the updates\n        The data is being maintained by ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://bedford.io/team/james-hadfield/"},"James Hadfield")," and ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://grubaughlab.com"},"Nathan Grubaugh's lab."),i.a.createElement("p",null),"Our goal is to promote sequencing and sharing of West Nile virus genomes to improve our understanding of virus spread and evolution.\n        To aid in this effort, Nathan Grubaugh, Ryan Smith, and Kristian Andersen have initiated a large study,\n        including >70 collaborators from >30 US states, to sequence ~4,000 West Nile virus genomes from across the country: ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://westnile4k.org/"},"WestNile 4K.")," Their website includes a complete list of collaborators and information on how to join the project.\n      To conduct such an ambitious sequencing project, they adapted their highly multiplexed PCR approach for ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://www.nature.com/articles/nprot.2017.066"},"Zika virus sequencing")," on the Illumina and Minion platforms for West Nile Virus circulating in North America. Their ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://grubaughlab.com/open-science/amplicon-sequencing/"},"sequencing protocol and primers")," are free to use.\n        If you have any questions about West Nile virus sequencing, or if you have unpublished data that you would like to share, please email ",i.a.createElement("a",{href:"emailto:grubaughlab@gmail.com"},"grubaughlab@gmail.com"),".",i.a.createElement("p",null),"All data shown here are coding-complete genomes.",i.a.createElement("p",null),"WNV is split into three phenotypically relevant strains - NY99, WN02 and SW03 (",i.a.createElement("span",{className:"link",onClick:function(){return e(Object(m.a)("wnv_strain"))}},"click here")," to colour the tree by this). These strains are defined by these mutations (click to change the colouring of the tree):",i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("span",{className:"link",onClick:function(){return e(Object(m.a)(Object(y.d)({gene:"env",positions:[159]})))}},"env-V159A")," designates the switch from NY99 (the original sequence) to WN02."),i.a.createElement("li",null,i.a.createElement("span",{className:"link",onClick:function(){return e(Object(m.a)(Object(y.d)({gene:"NS4A",positions:[85]})))}},"NS4A-A85T")," designates the switch from WN02 to SW03 (WN02 displaced NY99; WN02 and SW03 co-circulate).")))}(e);if(window.location.pathname.includes("h7n9"))return i.a.createElement("div",{className:"acknowledgments"},"We thank the ",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://gisaid.org"},"GISAID Initiative")," for enabling genomic surveillance of influenza and for providing a critical data sharing platform, and all of the groups who contribute to it.");if(window.location.pathname.includes("flu"))return i.a.createElement("div",null,i.a.createElement("div",{className:"acknowledgments"},"We thank the",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://gisaid.org"},"GISAID Initiative"),"and the",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://www.who.int/influenza/gisrs_laboratory/en/"},"GISRS Network"),"for critical surveillance efforts and open data sharing. Titer data used in antigenic analysis was generated by the",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://www.cdc.gov/flu/"},"Influenza Division at the US Centers for Disease Control and Prevention"),", the",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://www.crick.ac.uk/research/worldwide-influenza-centre"},"Worldwide Influenza Centre at the Francis Crick Institute"),", the",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"http://www.vidrl.org.au/"},"Victorian Infectious Diseases Reference Laboratory at the Australian Peter Doherty Institute for Infection and Immunity"),"and the",i.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://www.niid.go.jp/niid/en/flu-e.html"},"Influenza Virus Research Center at the Japan National Institute of Infectious Diseases"),"."),i.a.createElement("div",{className:"acknowledgments"},"Special thanks to Jackie Katz, Dave Wentworth, Becky Garten, Vivien Dugan, Xiyan Xu, Elizabeth Neuhaus, Sujatha Seenu, John McCauley, Rod Daniels, Vicki Gregory, Kanta Subbarao, Ian Barr, Aeron Hurt, Takato Odagiri, Shinji Watanabe, Tomoko Kuwahara, Michael Lässig, Marta Łuksza, Richard Reeve, Colin Russell, Sebastian Maurer-Stroh and Peter Bogner for feedback and advice. This analysis represents an updated frontend to the Nextflu informatic pipeline, originally available at nextflu.org."),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},i.a.createElement("div",{style:{flex:5}}),i.a.createElement("a",{key:5,href:"https://gisaid.org",target:"_blank",rel:"noreferrer noopener",style:{display:"flex",flexDirection:"column",justifyContent:"center"}},i.a.createElement("img",{alt:"gisaid-logo",width:"120",src:n(1122)})),i.a.createElement("div",{style:{flex:1}}),i.a.createElement("a",{key:6,href:"http://www.who.int/influenza/gisrs_laboratory/en/",target:"_blank",rel:"noreferrer noopener"},i.a.createElement("img",{alt:"gisrs-logo",width:"120",src:n(1123)})),i.a.createElement("div",{style:{flex:5}})))}return i.a.createElement("div",null,t)}var g,v=n(866);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===w(o)?o:String(o)),r)}var i,o}function E(e,t){return(E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var i=C(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T(this,n)}}function T(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=Object(r.lazy)((function(){return n.e(3).then(n.bind(null,1143))})),L=a.c.div.withConfig({displayName:"footer__FooterStyles",componentId:"sc-n42vt4-0"})(["margin-left:30px;padding-bottom:0px;font-family:",";font-size:15px;font-weight:300;color:rgb(136,136,136);line-height:1.4;p{font-weight:300;}ol{font-weight:300;}ul{font-weight:300;}h1{font-weight:700;font-size:2.50em;margin:0.2em 0;}h2{font-weight:600;font-size:2.15em;margin:0.2em 0;}h3{font-weight:500;font-size:1.70em;margin:0.2em 0;}h4{font-weight:500;font-size:1.25em;margin:0.1em 0;}h5{font-weight:500;font-size:1.0em;margin:0.1em 0;}h6{font-weight:500;font-size:0.85em;margin:0.1em 0;}pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px;}pre code{padding:0;margin:0;overflow:visible;font-size:100%;line-height:inherit;word-wrap:normal;background-color:initial;border:0;}p code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px;}.line{margin-top:15px;margin-bottom:15px;border-bottom:1px solid #CCC;}.acknowledgments{margin-top:10px;}.filterList{margin-top:10px;line-height:1.0;}.imageContainer{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;}img{margin-left:30px;margin-right:30px;margin-top:2px;margin-bottom:2px;}table{font-weight:300;margin-bottom:1rem;th,td{text-align:left;padding:0.45rem;vertical-align:top;border-top:1px solid #dee2e6;}thead th{vertical-align:bottom;border-bottom:2px solid #dee2e6;}tbody + tbody{border-top:2px solid #dee2e6;}}"],p.b),I=function(e,t){if(e.description)return i.a.createElement(r.Suspense,{fallback:i.a.createElement("div",null)},i.a.createElement(P,{className:"acknowledgments",mdstring:e.description}));var n=i.a.createElement("div",null,"This work is made possible by the open sharing of genetic data by research groups from all over the world. We gratefully acknowledge their contributions.");return"nextstrain.org"===window.location.hostname?b(t,n):i.a.createElement("div",null,n)},N=a.c.div.withConfig({displayName:"footer__TitleContainer",componentId:"sc-n42vt4-1"})(["display:flex;justify-content:space-between;margin:0px;padding:0px;"]),_=a.c.span.withConfig({displayName:"footer__IconContainer",componentId:"sc-n42vt4-2"})(["font-size:22px;font-weight:500;"]),B=function(e){var t=e.name,n=e.isExpanded,r=void 0!==n&&n;return i.a.createElement(N,null,t,i.a.createElement(_,null,r?i.a.createElement(u.b,null):i.a.createElement(u.a,null)))},A=Object(o.b)((function(e){return{tree:e.tree,totalStateCounts:e.tree.totalStateCounts,metadata:e.metadata,colorOptions:e.metadata.colorOptions,browserDimensions:e.browserDimensions.browserDimensions,activeFilters:e.controls.filters,filtersInFooter:e.controls.filtersInFooter}}))(g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(a,e);var t,n,r,o=k(a);function a(){return x(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"shouldComponentUpdate",value:function(e){if(this.props.tree.version!==e.tree.version||this.props.browserDimensions!==e.browserDimensions)return!0;if(Object.keys(this.props.activeFilters)!==Object.keys(e.activeFilters))return!0;if(Object.keys(this.props.activeFilters).length>0){var t,n=O(this.props.activeFilters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.props.activeFilters[r]!==e.activeFilters[r])return!0}}catch(e){n.e(e)}finally{n.f()}}return!1}},{key:"displayFilter",value:function(e){var t,n,r,o=this,a=this.props.t,s=this.props.totalStateCounts[e],l=this.props.metadata.colorings[e]?this.props.metadata.colorings[e].title:e,u=this.props.activeFilters[e].filter((function(e){return e.active})).map((function(e){return e.value})),p=i.a.createElement("div",null,a("Filter by {{filterTitle}}",{filterTitle:l})+" (n=".concat(s.size,")"),this.props.activeFilters[e].length?(t=this.props.dispatch,n=[e],r=a("Clear {{filterName}} filter",{filterName:e}),i.a.createElement(v.b,{active:!0,extraStyles:{float:"right",margin:"0px 4px"},onClick:function(){n.forEach((function(e){return t(Object(d.a)("set",e,[]))}))}},r)):null);return i.a.createElement("div",null,i.a.createElement(c.a,{triggerWhenOpen:i.a.createElement(B,{name:p,isExpanded:!0}),trigger:i.a.createElement(B,{name:p}),triggerStyle:{cursor:"pointer",textDecoration:"none"},transitionTime:100},i.a.createElement("div",{className:"filterList"},i.a.createElement(h.a,{wrap:"wrap",justifyContent:"flex-start",alignItems:"center"},Array.from(s.keys()).filter((function(e){return Object(f.C)(e)})).sort().map((function(t){return i.a.createElement(v.b,{key:t,active:-1!==u.indexOf(t),onClick:function(){return function(e,t,n,r){var i=-1===t[n].map((function(e){return e.value})).indexOf(r)?"add":"remove";e(Object(d.a)(i,n,[r]))}(o.props.dispatch,o.props.activeFilters,e,t)}},i.a.createElement("span",null,"".concat(t," (").concat(s.get(t),")")))}))))))}},{key:"render",value:function(){var e=this;if(!this.props.metadata||!this.props.tree.nodes)return null;var t=this.props.width-30;return i.a.createElement(L,null,i.a.createElement("div",{style:{width:t}},i.a.createElement("div",{className:"line"}),I(this.props.metadata,this.props.dispatch),i.a.createElement("div",{className:"line"}),Object.keys(this.props.activeFilters).filter((function(t){return e.props.filtersInFooter.includes(t)})).map((function(t){return i.a.createElement("div",{key:t},e.displayFilter(t),i.a.createElement("div",{className:"line"}))}))))}}])&&j(t.prototype,n),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.a.Component))||g,R=Object(l.a)()(A);t.a=R},953:function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return b}));var r=n(1153),i=n(1154),o=n(841),a=n(1162),s=(n(838),n(818)),c=n(839),l=n(832);function u(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=function(){"majorGrid"in this.groups&&this.groups.majorGrid.selectAll("*").style("visibility","hidden"),"minorGrid"in this.groups&&this.groups.minorGrid.selectAll("*").style("visibility","hidden"),"gridText"in this.groups&&this.groups.gridText.selectAll("*").style("visibility","hidden"),"axisText"in this.groups&&this.groups.axisText.selectAll("*").style("visibility","hidden")},d=function(e,t,n,r,i){for(var o=[],a=[],s=function(e,t){var n=Math.floor(Math.log10(e)),r=Math.pow(10,n);e/r<2?r/=5:e/r<5&&(r/=2);var i=t;return 5!==r&&10!==r||(i=5),{majorStep:r,minorStep:r/i}}(t-e,r),c=s.majorStep,l=s.minorStep,u=Math.floor(e/c)*c,p="radial"===n?e:u,h=t,d=0;d<=(t-u)/c+3;d++){var f=u+c*d;o.push({position:f,name:f.toFixed(Math.max(0,-Math.floor(Math.log10(c)))),visibility:f<p||f>h?"hidden":"visible",axis:i});for(var m=f+l;m<f+c&&m<t;m+=l)a.push({position:m,visibility:m<p||m>h+l?"hidden":"visible",axis:i})}return{majorGridPoints:o,minorGridPoints:a}},f=function(e,t,n,r){for(var i=[],o=[],a=function(e,t){var n={unit:"DAY",n:1},r={unit:"DAY",n:0},i=t<1e3?130:180,o=e/Math.floor(t/i),a={CENTURY:{t:100,max:void 0},DECADE:{t:10,max:5},FIVEYEAR:{t:5,max:1},YEAR:{t:1,max:3},MONTH:{t:1/12,max:6},WEEK:{t:1/52,max:1},DAY:{t:1/365,max:3}},s=Object.keys(a);n.unit="DAY";for(var c=0;c<s.length-1;c++)if(o>a[s[c]].t){n.unit=s[c];break}n.n=Math.floor(o/a[n.unit].t)||1,a[n.unit].max&&n.n>a[n.unit].max&&(n.unit=s[s.indexOf(n.unit)-1],n.n=Math.floor(o/a[n.unit].t)||1),n.n>1||"DAY"===n.unit?r.unit=n.unit:r.unit=s[s.indexOf(n.unit)+1];var l=n.n*a[n.unit].t;return r.n=Math.ceil(a[r.unit].t/l),{majorStep:n,minorStep:r}}(t-e,Math.abs(n)),s=a.majorStep,c=a.minorStep,u=Object(l.e)(s.unit,Object(l.h)(t)),p=Object(l.f)(s.unit,Object(l.h)(e));p<u;){i.push({date:p,position:Object(l.a)(Object(l.d)(p)),name:Object(l.i)(s.unit,p),visibility:"visible",axis:r});for(var h=0;h<s.n;h++)p=Object(l.e)(s.unit,p)}return c.n&&i.forEach((function(e,t){p=Object(l.e)(c.unit,e.date);for(var n=0;n<c.n-1;n++)p=Object(l.e)(c.unit,p);for(var a=t===i.length-1?u:i[t+1].date;p<a;){o.push({position:Object(l.a)(Object(l.d)(p)),visibility:"visible",axis:r});for(var s=0;s<c.n;s++)p=Object(l.e)(c.unit,p)}})),{majorGridPoints:i,minorGridPoints:o}},m=function(){var e,t,n=this.layout;if(e=this.groups,t=this.svg,"temporalWindow"in e||(e.temporalWindow=t.append("g").attr("id","temporalWindow"),e.temporalWindowStart=e.temporalWindow.append("rect").attr("class","temporalWindowStart"),e.temporalWindowEnd=e.temporalWindow.append("rect").attr("class","temporalWindowEnd")),"majorGrid"in e||(e.majorGrid=t.append("g").attr("id","majorGrid").attr("clip-path","url(#treeClip)")),"minorGrid"in e||(e.minorGrid=t.append("g").attr("id","minorGrid").attr("clip-path","url(#treeClip)")),"gridText"in e||(e.gridText=t.append("g").attr("id","gridText")),"axisText"in e||(e.axisText=t.append("g").attr("id","axisText")),"unrooted"!==n){var o,a,s,l=Object(r.a)(this.yScale.domain()),p=Object(i.a)(this.yScale.domain()),h="radial"===n?this.nodes[0].depth:this.xScale.domain()[0],m="radial"===n?h+Object(i.a)([this.xScale.domain()[1],this.yScale.domain()[1],-this.xScale.domain()[0],-this.yScale.domain()[0]]):this.xScale.domain()[1],y=this.xScale.range()[1]-this.xScale.range()[0],b="scatter"===this.layout&&"num_date"===this.scatterVariables.x||"clock"===this.layout||"scatter"!==this.layout&&"num_date"===this.distance?f(h,m,y,"x"):"scatter"!==this.layout||this.scatterVariables.xContinuous?d(h,m,n,this.params.minorTicks,"x"):{majorGridPoints:this.xScale.domain().map((function(e){return{name:e,visibility:"visible",axis:"x",position:e}})),minorGridPoints:[]},g=b.majorGridPoints,v=b.minorGridPoints,w=function(e,t,n){return function(r){var i="";if("x"===r.axis){if("rect"===n||"clock"===n||"scatter"===n){var o=e(r.position);i="M"+o.toString()+" "+t.range()[1].toString()+" L "+o.toString()+" "+t.range()[0].toString()}else if("radial"===n){var a=e(r.position-h);i="M "+a.toString()+"  "+t(0).toString()+" A "+(a-e(0)).toString()+" "+(t(r.position)-t(h)).toString()+" 0 1 0 "+a.toString()+" "+(t(0)+.001).toString()}}else if("y"===r.axis){var s=t(r.position);i="M".concat(e(h)+20," ").concat(s," L ").concat(e(m)," ").concat(s)}return i}};if("clock"===this.layout||"scatter"===this.layout)if("scatter"===this.layout&&"num_date"===this.scatterVariables.y){var O=this.yScale.range()[1]-this.yScale.range()[0],S=f(l,p,O,"y");g.push.apply(g,u(S.majorGridPoints))}else if("scatter"!==this.layout||this.scatterVariables.yContinuous){var x=d(l,p,n,1,"y");g.push.apply(g,u(x.majorGridPoints))}else g.push.apply(g,u(this.yScale.domain().map((function(e){return{name:e,visibility:"visible",axis:"y",position:e}}))));this.groups.majorGrid.selectAll("*").remove(),this.groups.majorGrid.selectAll(".majorGrid").data(g).enter().append("path").attr("d",w(this.xScale,this.yScale,n)).attr("class","majorGrid").style("fill","none").style("visibility",(function(e){return e.visibility})).style("stroke",this.params.majorGridStroke).style("stroke-width",this.params.majorGridWidth),this.groups.minorGrid.selectAll("*").remove(),this.svg.selectAll(".minorGrid").remove(),this.groups.minorGrid.selectAll(".minorGrid").data(v).enter().append("path").attr("d",w(this.xScale,this.yScale,n)).attr("class","minorGrid").style("fill","none").style("visibility",(function(e){return e.visibility})).style("stroke",this.params.minorGridStroke).style("stroke-width",this.params.minorGridWidth),this.groups.gridText.selectAll("*").remove(),this.svg.selectAll(".gridText").remove(),this.groups.gridText.selectAll(".gridText").data(g).enter().append("text").text((function(e){return e.name})).attr("class","gridText").style("font-size",this.params.tickLabelSize).style("font-family",this.params.fontFamily).style("fill",this.params.tickLabelFill).style("text-anchor",(o=n,function(e){return"x"===e.axis?"radial"===o?"end":"middle":"start"})).style("visibility",(function(e){return e.visibility})).attr("x",function(e,t){return function(n){return"x"===n.axis?e("radial"===t?0:n.position):e.range()[0]-15}}(this.xScale,n)).attr("y",function(e,t){return function(n){return"x"===n.axis?"radial"===t?e(n.position-h)-5:e.range()[1]+18:e(n.position)}}(this.yScale,n)),this.groups.axisText.selectAll("*").remove(),this.svg.selectAll(".axisText").remove(),"clock"===n?(s="Date",a=Object(c.f)(this.yScale)?"Divergence":"Mutations"):"scatter"===n?("div"===(s=this.scatterVariables.xLabel)&&(s=Object(c.f)(this.xScale)?"Divergence":"Mutations"),"div"===(a=this.scatterVariables.yLabel)&&(a=Object(c.f)(this.yScale)?"Divergence":"Mutations")):"rect"===n&&(s="num_date"===this.distance?"Date":Object(c.f)(this.xScale)?"Divergence":"Mutations"),s&&this.groups.axisText.append("text").text(s).attr("class","gridText").style("font-size",this.params.tickLabelSize).style("font-family",this.params.fontFamily).style("fill",this.params.tickLabelFill).style("text-anchor","middle").attr("x",Math.abs(this.xScale.range()[1]-this.xScale.range()[0])/2).attr("y",parseInt(this.svg.attr("height"),10)-1),a&&this.groups.axisText.append("text").text(a).attr("class","gridText").style("font-size",this.params.tickLabelSize).style("font-family",this.params.fontFamily).style("fill",this.params.tickLabelFill).style("text-anchor","middle").attr("transform","translate(10,"+this.yScale.range()[1]/2+") rotate(-90)"),this.grid=!0}},y=function(){this.groups.temporalWindowStart.attr("opacity",0),this.groups.temporalWindowEnd.attr("opacity",0)},b=(Object(o.b)("temporalWindowTransition").duration(s.d).ease(a.a),function(){if("rect"===this.layout&&"num_date"===this.distance){var e=[this.xScale(this.dateRange[0]),this.xScale(this.dateRange[1])],t=this.yScale.range()[1],n=-1===this.params.orientation[0],r=this.xScale(this.nodes[0].x),i=n?this.xScale.range()[0]:this.xScale.range()[1];if(i+=this.margins.left+this.margins.right,Math.abs(e[0]-r)>30){var o=e[0],a=0;n&&(o=i-e[0],a=e[0]);var s="1"===this.groups.temporalWindowStart.attr("opacity");this.groups.temporalWindowStart.attr("opacity",1).attr("height",t).attr("transform","translate(".concat(a,",0)")).attr("fill","#EEE"),s?this.groups.temporalWindowStart.transition("temporalWindowTransition").attr("width",o):this.groups.temporalWindowStart.attr("width",o)}else this.groups.temporalWindowStart.attr("opacity",0);var c=e[1],l=i-this.margins.right-e[1],u="translate(".concat(i-this.margins.right,",0) scale(-1,1)");if(n&&(c=this.margins.right,l=e[1]-this.margins.right,u="translate(".concat(c,",0)")),l>30){var p="1"===this.groups.temporalWindowEnd.attr("opacity");this.groups.temporalWindowEnd.attr("opacity",1).attr("height",t).attr("fill","#EEE").attr("transform",u),p?this.groups.temporalWindowEnd.transition("temporalWindowTransition").attr("width",l):this.groups.temporalWindowEnd.attr("width",l)}else this.groups.temporalWindowEnd.attr("opacity",0)}else this.hideTemporalSlice()})},954:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(1),i=n.n(r),o=n(822),a=n(832),s=n(834),c=n(828),l=n(823),u=n(818),p=n(839),h=n(955);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=e.name,n=e.value,r=e.padBelow,o=void 0!==r&&r;return i.a.createElement("div",{style:{paddingBottom:o?"15px":"10px"},key:t},i.a.createElement("span",{style:{fontWeight:"500"}},t+" "),n||0===n?Array.isArray(n)?n.map((function(e){return i.a.createElement("div",{key:e,style:{fontWeight:"300",marginLeft:"0em"}},e)})):i.a.createElement("span",{style:{fontWeight:"300"}},n):null)},b=function(e){var t=e.name;return i.a.createElement("div",{style:o.e.tooltipHeading},t)},g=function(e){var t=e.node,n=e.t,r=[],o=Object(l.e)(t),s=Object(l.h)(t,"num_date");if(o&&r.push(i.a.createElement(y,{name:n("Divergence")+":",value:Object(p.b)(o),key:"div"})),void 0!==s){var c=Object(a.g)(s),u=Object(l.h)(t,"num_date",{confidence:!0});if(u&&u[0]!==u[1]){r.push(i.a.createElement(y,{name:n("Inferred Date")+":",value:c,key:"inferredDate"}));var h=[Object(a.g)(u[0]),Object(a.g)(u[1])];h[0]!==h[1]&&r.push(i.a.createElement(y,{name:n("Date Confidence Interval")+":",value:"(".concat(h[0],", ").concat(h[1],")"),key:"dateConf"}))}else r.push(i.a.createElement(y,{name:n("Date")+":",value:c,key:"date"}))}return r},v=function(e){var t=e.node,n=e.colorBy,r=e.colorByConfidence,o=e.colorScale,p=e.colorings;if("num_date"===n)return null;if(Object(c.f)(n)){var h=Object(c.a)(n),d=h.aa?"Amino Acid at ".concat(h.gene," site ").concat(h.positions.join(", "),":"):"Nucleotide at pos ".concat(h.positions.join(", "),":");return i.a.createElement(y,{name:d,value:Object(s.i)(t,o)})}if("author"===n){var f=Object(l.f)(t);return f?i.a.createElement(i.a.Fragment,null,f.title?i.a.createElement(y,{name:"Title:",value:f.title}):null,f.journal?i.a.createElement(y,{name:"Journal:",value:f.journal}):null):null}var m=p&&p[n]&&p[n].title?p[n].title:n,b=Object(l.h)(t,n);if("temporal"===o.scaleType&&"number"==typeof b)return i.a.createElement(y,{name:"".concat(m,":"),value:Object(a.g)(b)});var g=function(){return Object(u.C)(b)?i.a.createElement(y,{name:"".concat(m,":"),value:b}):null};if(!0===r){var v=Object(l.h)(t,n,{confidence:!0});if(!v)return console.error("couldn't find confidence vals for ",n),null;if(!t.hasChildren&&1===Object.keys(v).length&&Object.values(v)[0]>.99)return g();var w=Object.keys(v).filter((function(e){return Object(u.C)(e)})).sort((function(e,t){return v[e]>v[t]?-1:1})).slice(0,4).map((function(e){return"".concat(e," (").concat((100*v[e]).toFixed(0),"%)")}));return w.length?i.a.createElement(y,{name:"".concat(m," (confidence):"),value:w}):null}return g()},w=function(e){var t=e.node,n=e.t,r=Object(l.g)(t);if(!r.nuc)return null;var o={changes:0,gaps:0,reversionsToRoot:0,ns:0},a={changes:0,gaps:0,reversionsToRoot:0};Object.keys(r).forEach((function(e){Object.entries(r[e]).forEach((function(t){var n=d(t,2),r=n[0],i=n[1];"nuc"===e?o[r]+=i.length:a[r]+=i.length}))}));var s="".concat(o.changes).concat(o.reversionsToRoot?" + ".concat(o.reversionsToRoot," reversions to root"):"");s+="".concat(o.gaps?" + ".concat(o.gaps," gaps"):"").concat(o.nt?" + ".concat(o.nt," Ns"):"");var c="".concat(a.changes).concat(a.reversionsToRoot?" + ".concat(a.reversionsToRoot," reversions to root"):"");return c+="".concat(a.gaps?" + ".concat(a.gaps," gaps"):""),[i.a.createElement(y,{name:n("Nucleotide changes")+":",value:s,key:"nuc"}),i.a.createElement(y,{name:n("Amino Acid changes")+":",value:c,key:"aa"})]},O=function(e){var t=e.node,n=e.geneSortFn,r=e.observedMutations,o=e.t;if(!t.branch_attrs||!t.branch_attrs.mutations)return null;var a=[],s=t.branch_attrs.mutations,c=Object(l.d)(t,r),u=function(e,t){return e.slice(0,Math.min(t,e.length)).join(", ")+(e.length>t?" + ".concat(e.length-t," more"):"")};if(c.nuc){if(c.nuc.unique.length&&a.push(i.a.createElement(y,{name:"Unique Nucleotide mutations:",value:u(c.nuc.unique,5),key:"nuc_unique"})),c.nuc.homoplasies.length&&a.push(i.a.createElement(y,{name:"Homoplasic mutations:",value:u(c.nuc.homoplasies,5),key:"nuc_homoplasies"})),c.nuc.reversionsToRoot.length&&a.push(i.a.createElement(y,{name:"Reversions to Root:",value:c.nuc.reversionsToRoot.length,key:"nuc_rtr"})),c.nuc.gaps.length){var p="".concat(Object(h.b)(c.nuc.gaps).length," regions, ").concat(c.nuc.gaps.length,"bp.");a.push(i.a.createElement(y,{name:"Gaps:",value:p,key:"nuc_gaps"}))}if(c.nuc.undeletions.length){var d="".concat(Object(h.b)(c.nuc.undeletions).length," regions, ").concat(c.nuc.undeletions.length,"bp.");a.push(i.a.createElement(y,{name:"Undeletions:",value:d,key:"nuc_undeletions"}))}if(c.nuc.ns.length){var m="".concat(Object(h.b)(c.nuc.ns).length," regions, ").concat(c.nuc.ns.length,"bp.");a.push(i.a.createElement(y,{name:"Ns:",value:m,key:"nuc_ns"}))}}else a.push(i.a.createElement(y,{name:o("No nucleotide mutations"),value:"",key:"nuc"}));var b,g=Object.keys(s).sort(n).filter((function(e){return"nuc"!==e})),v={},w=!1,O=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(g);try{for(O.s();!(b=O.n()).done;){var S=b.value,x=s[S].filter((function(e){return!e.endsWith("X")}));x.length&&(v[S]=x,w=!0)}}catch(e){O.e(e)}finally{O.f()}if(w){var j=[];Object.keys(v).forEach((function(e,t){if(t<7){var n=e+":  "+v[e].slice(0,Math.min(3,v[e].length)).join(", ");v[e].length>3&&(n+=" + "+o("{{x}} more",{x:v[e].length-3})),j.push(n)}else 7===t&&j.push("(".concat(o("protein mutations truncated"),")"))})),a.push(i.a.createElement(y,{name:o("AA mutations")+":",value:j,key:"aa"}))}else s.nuc&&s.nuc.length&&a.push(i.a.createElement(y,{name:o("No amino acid mutations"),key:"aa"}));return a},S=function(e){var t=e.node,n=e.t,r=d(1===t.fullTipCount?[n("Branch leading to"),t.name]:[n("Number of descendants")+":",t.fullTipCount],2),o=r[0],a=r[1];return i.a.createElement(y,{name:o,value:a,padBelow:!0})},x=function(e){var t=e.node,n=e.t,r=Object(l.j)(t);if(!r)return null;var o=[];return r.selection_date&&o.push(i.a.createElement(y,{name:n("Vaccine selected")+":",value:r.selection_date,key:"seldate"})),r.start_date&&o.push(i.a.createElement(y,{name:n("Vaccine start date")+":",value:r.start_date,key:"startdate"})),r.end_date&&o.push(i.a.createElement(y,{name:n("Vaccine end date")+":",value:r.end_date,key:"enddate"})),r.serum&&o.push(i.a.createElement(y,{name:n("Serum strain"),key:"serum"})),o},j=function(e){var t=e.node,n=[],r=Object(l.f)(t);r&&n.push(i.a.createElement(y,{name:"Author:",value:r.value,key:"author"}));var o=Object(l.h)(t,"gisaid_epi_isl");if(Object(u.C)(o)){var a=o.split("_")[2];n.push(i.a.createElement(y,{name:"GISAID EPI ISL:",value:a,key:"gisaid_epi_isl"}))}return n},E=function(e){var t=e.node,n=e.panelDims,r=e.children,a=200;a=n.width<420?200:n.width<460?220:n.width<500?240:n.width<540?260:280;var s=-1===t.shell.that.params.orientation[0]?n.width/2+n.spaceBetweenTrees+t.shell.xTip:t.shell.xTip,c=t.shell.yTip,l={container:{position:"absolute",width:a,padding:"10px",borderRadius:10,zIndex:1e3,pointerEvents:"none",fontFamily:o.e.panel.fontFamily,fontSize:14,lineHeight:1,fontWeight:o.e.panel.fontWeight,color:o.e.panel.color,backgroundColor:o.e.panel.backgroundColor,wordWrap:"break-word",wordBreak:"break-word"}};return s<.5*n.width?l.container.left=s+10:l.container.right=n.width-s+10,c<.55*n.height?l.container.top=c+40:l.container.bottom=n.height-c+10,i.a.createElement("div",{style:l.container},i.a.createElement("div",{className:"tooltip",style:o.e.tooltip},r))},k=function(e){var t=e.children;return i.a.createElement("div",{style:o.e.comment},t)};t.b=function(e){var t=e.selectedNode,n=e.colorBy,r=e.colorByConfidence,o=e.colorScale,a=e.panelDims,s=e.colorings,c=e.geneSortFn,l=e.observedMutations,u=e.t;if("hover"!==t.event)return null;var h=t.node.n,d=Object(p.d)(h);return i.a.createElement(E,{node:h,panelDims:a},"tip"===t.type?i.a.createElement(i.a.Fragment,null,i.a.createElement(b,{name:h.name}),i.a.createElement(x,{node:h,t:u}),i.a.createElement(w,{node:h,t:u}),i.a.createElement(g,{node:h,t:u}),i.a.createElement(v,{node:h,colorBy:n,colorByConfidence:r,colorScale:o,colorings:s}),i.a.createElement(j,{node:h}),i.a.createElement(k,null,u("Click on tip to display more info"))):i.a.createElement(i.a.Fragment,null,i.a.createElement(S,{node:h,t:u}),i.a.createElement(O,{node:h,geneSortFn:c,observedMutations:l,t:u}),i.a.createElement(g,{node:h,t:u}),i.a.createElement(v,{node:h,colorBy:n,colorByConfidence:r,colorScale:o,colorings:s}),i.a.createElement(k,null,d===h.arrayIdx?u("Click to zoom out to parent clade"):u("Click to zoom into clade")),i.a.createElement(k,null,u("Shift + Click to display more info"))))}},955:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return j}));var r=n(1),i=n.n(r),o=n(797),a=n(827),s=n(823),c=n(821);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=o.c.button.withConfig({displayName:"MutationTable__Button",componentId:"sc-1qenp7x-0"})(["border:0px;background-color:inherit;cursor:pointer;outline:0;text-decoration:underline;font-size:16px;padding:0px 0px;"]),h=function(e,t){var n=[parseInt(e.slice(1,-1),10),parseInt(t.slice(1,-1),10)];return n[0]<n[1]?-1:1},d=function(e){var t=[];return e.sort(h).forEach((function(e,n){var r=parseInt(e.slice(1,-1),10);0===n||r!==t[t.length-1].end+1?t.push({start:r,end:r,count:1,char:e.slice(-1)}):(t[t.length-1].end=r,t[t.length-1].count+=1)})),t},f=o.c.p.withConfig({displayName:"MutationTable__Heading",componentId:"sc-1qenp7x-1"})(["margin-top:12px;margin-bottom:4px;"]),m=o.c.span.withConfig({displayName:"MutationTable__SubHeading",componentId:"sc-1qenp7x-2"})(["padding-right:8px;"]),y=o.c.span.withConfig({displayName:"MutationTable__MutationList",componentId:"sc-1qenp7x-3"})([""]),b=o.c.p.withConfig({displayName:"MutationTable__MutationLine",componentId:"sc-1qenp7x-4"})(["margin:0px 0px 4px 0px;font-weight:300;font-size:16px;"]),g=o.c.td.withConfig({displayName:"MutationTable__TableFirstColumn",componentId:"sc-1qenp7x-5"})(["font-weight:500;white-space:nowrap;vertical-align:baseline;"]),v=function(e){var t,n,r=e.name,o=e.muts,a=e.displayAsIntervals,s=e.isNuc;if(a){var c=d(o);n="".concat(r," (").concat(c.length," regions, ").concat(o.length).concat(s?"bp":" codons","):"),t=c.map((function(e){return 1===e.count?"".concat(e.start):"".concat(e.start,"..").concat(e.end," (").concat(e.count," ").concat(s?"bp":"codons",")")})).join(", ")}else n="".concat(r," (").concat(o.length,"):"),t=o.sort(h).join(", ");return i.a.createElement(b,null,i.a.createElement(m,{key:r},n),i.a.createElement(y,null,t))},w={unique:"Unique",changes:"Changes",homoplasies:"Homoplasies",reversionsToRoot:"Reversions to root",undeletions:"Undeletions",gaps:"Gaps",ns:"Ns "},O=o.c.span.withConfig({displayName:"MutationTable__InfoContainer",componentId:"sc-1qenp7x-6"})(["padding-left:10px;cursor:help;color:#888;"]),S=i.a.createElement("div",null,"A summary of mutations inferred to have occurred on this branch. Mutations are grouped into one of the following (mutually exclusive) categories, with the first matching category used:",i.a.createElement("ol",null,i.a.createElement("li",null,"Undeletions: a change from a '-' character to a base; beware that these are often bioinformatics artifacts"),i.a.createElement("li",null,"Gaps: A change to a '-' character, indicating a missing base; these can indicate deletions but sometimes areas of no coverage are filled with gaps"),i.a.createElement("li",null,"Ns: Typically due to lack of sequence coverage or ambiguity at this position (Nucleotides only)"),i.a.createElement("li",null,"Homoplasies: a mutation that has also been observed elsewhere on the tree"),i.a.createElement("li",null,"Unique: Mutations which are only observed on this branch")),"Reversions to Root is an additional category which highlights those mutations which return the state to that of the root. Mutations in this category will also appear one of the five categories listed above.",i.a.createElement("p",null),"Gaps and Ns are grouped into intervals, as they frequently occur in succession. Click below to copy all changes to clipboard to see the full list."),x=i.a.createElement("div",null,"A summary of sequence changes between the root and the selected tip. Changes are grouped into one of the following (mutually exclusive) categories, with the first matching category used:",i.a.createElement("ol",null,i.a.createElement("li",null,"Gaps: A change to a '-' character, indicating a missing base; these can indicate deletions but sometimes areas of no coverage are filled with gaps"),i.a.createElement("li",null,"Ns: Typically due to lack of sequence coverage or ambiguity at this position (Nucleotides only)"),i.a.createElement("li",null,"Reversions to root: The tip state is the same as the root state, however this has changed and been reverted along the way"),i.a.createElement("li",null,"Changes: The tip state differs from the root state")),"Gaps and Ns are grouped into intervals, as they frequently occur in succession. Click below to copy all changes to clipboard to see the full list."),j=function(e){var t=e.node,n=e.geneSortFn,r=e.isTip,o=e.observedMutations,u=r?Object(s.g)(t):Object(s.d)(t,o);return 0===Object.keys(u).length?i.a.createElement(f,null,r?"No sequence changes observed":"No mutations observed on branch"):i.a.createElement(i.a.Fragment,null,i.a.createElement(f,null,r?"Sequence changes observed (from root)":"Mutations observed on branch",i.a.createElement(O,{"data-tip":!0,"data-for":"seqChangesInfo"},i.a.createElement(a.i,null))),i.a.createElement(c.h,{place:"bottom",type:"light",effect:"solid",id:"seqChangesInfo"},r?x:S),i.a.createElement("table",null,i.a.createElement("tbody",null,Object.keys(u).sort(n).map((function(e){return function(e,t){return 0===Object.values(t).filter((function(e){return e.length})).length?null:i.a.createElement("tr",{key:e},i.a.createElement(g,null,"nuc"===e?"Nt":e),i.a.createElement("td",null,Object.entries(w).map((function(n){var r=l(n,2),o=r[0],a=r[1];return o in t&&t[o].length?i.a.createElement(v,{key:a,name:a,muts:t[o],displayAsIntervals:"gaps"===o||"ns"===o||"undeletions"===o,isNuc:"nuc"===e}):null}))))}(e,u[e])})),i.a.createElement("tr",null,i.a.createElement("td",null),i.a.createElement("td",null,i.a.createElement(p,{onClick:function(){navigator.clipboard.writeText(function(e,t){return Object.keys(e).sort(t).map((function(t){return Object.keys(w).filter((function(n){return n in e[t]&&e[t][n].length})).map((function(n){return"".concat(t,"\t").concat(n,"\t").concat(e[t][n].sort(h).join(", "))}))})).flat().join("\n")}(u,n))}},"Click to copy all ".concat(r?"changes":"mutations"," to clipboard as TSV")))))))}},956:function(e,t,n){"use strict";n.d(t,"b",(function(){return d}));var r=n(1),i=n.n(r),o=n(818),a=n(822),s=n(832),c=n(823),l=n(955);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){e||(e=window.event),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},f=function(e,t,n){return i.a.createElement("tr",{key:e},i.a.createElement("th",{style:a.e.item},e),i.a.createElement("td",{style:a.e.item},n?i.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},t):t))},m=function(e){var t=e.url,n=e.title,r=e.value;return i.a.createElement("tr",null,i.a.createElement("th",{style:a.e.item},n),i.a.createElement("td",{style:a.e.item},i.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},r)))},y=function(e){var t=e.node,n=Object(c.h)(t,"gisaid_epi_isl"),r=Object(c.h)(t,"genbank_accession"),a=null,s=null;if(Object(o.C)(n))if(new RegExp("EPI_ISL_[0-9]{5,}").test(n)){var l=n.split("_")[2];a="https://www.epicov.org/acknowledgement/"+l.slice(-4,-2)+"/"+l.slice(-2)+"/"+n+".json"}else a="https://gisaid.org";if(Object(o.C)(r)&&(s="https://www.ncbi.nlm.nih.gov/nuccore/"+r),Object(o.C)(n)&&Object(o.C)(r))return i.a.createElement(i.a.Fragment,null,i.a.createElement(m,{title:"GISAID EPI ISL",value:n,url:a}),i.a.createElement(m,{title:"Genbank accession",value:r,url:s}));if(Object(o.C)(n))return i.a.createElement(m,{title:"GISAID EPI ISL",value:n,url:a});if(Object(o.C)(r))return i.a.createElement(m,{title:"Genbank accession",value:r,url:s});var u=Object(c.c)(t),p=u.accession,h=u.url;return p&&h?i.a.createElement(m,{url:h,value:p,title:"Accession"}):p?f("Accession",p):h?i.a.createElement(m,{title:"Strain URL",url:h,value:"click here"}):null},b=function(e){var t=e.node,n=e.t,r=Object(c.j)(t);if(!r)return null;var o=[];return r.selection_date&&o.push(i.a.createElement("tr",{key:"seldate"},i.a.createElement("th",null,n("Vaccine selected")),i.a.createElement("td",null,r.selection_date))),r.start_date&&o.push(i.a.createElement("tr",{key:"startdate"},i.a.createElement("th",null,n("Vaccine start date")),i.a.createElement("td",null,r.start_date))),r.end_date&&o.push(i.a.createElement("tr",{key:"enddate"},i.a.createElement("th",null,n("Vaccine end date")),i.a.createElement("td",null,r.end_date))),r.serum&&o.push(i.a.createElement("tr",{key:"serum"},i.a.createElement("th",null,n("Serum strain")),i.a.createElement("td",null))),o},g=function(e){var t=e.node,n=e.t,r=Object(c.f)(t);if(!r)return null;var i=[];return i.push(f(n("Authors"),r.value)),r.title&&"?"!==r.title&&(r.paper_url&&"?"!==r.paper_url?i.push(f(n("Title"),r.title,r.paper_url)):i.push(f(n("Title"),r.title))),r.journal&&"?"!==r.journal&&i.push(f(n("Journal"),r.journal)),1===i.length?i[0]:i},v=function(e){var t=e.children;return i.a.createElement("p",{style:a.e.modalHeading},t)},w=function(e){var t=e.isTerminal,n=e.node,r=e.t,o=Object(c.h)(n,"num_date");if(!o)return null;var a=Object(c.h)(n,"num_date",{confidence:!0});return o&&a&&a[0]!==a[1]?i.a.createElement(i.a.Fragment,null,f(r(t?"Inferred collection date":"Inferred date"),Object(s.g)(o)),f(r("Date Confidence Interval"),"(".concat(Object(s.g)(a[0]),", ").concat(Object(s.g)(a[1]),")"))):f(r(t?"Collection date":"Inferred date"),Object(s.g)(o))},O=function(e){var t,n=e.node,r=e.trait,a=e.colorings,l=e.isTerminal,u=Object(c.h)(n,r),p=Object(c.h)(n,r,{confidence:!0}),h="temporal"===(null===(t=a[r])||void 0===t?void 0:t.type);if("number"!=typeof u||h||Number.isInteger(u)||(u=Number.parseFloat(u).toPrecision(3)),!Object(o.C)(u))return null;p&&u in p&&(!l||p[u]<.99)&&(u="".concat(u," (").concat((100*p[u]).toFixed(0),"%)"));var d=a&&a[r]&&a[r].title?a[r].title:r;if(h&&"number"==typeof u)return f(d,Object(s.g)(u));var y=Object(c.i)(n,r);return y?i.a.createElement(m,{title:d,url:y,value:u}):f(d,u)};t.a=function(e){var t=e.selectedNode,n=e.clearSelectedNode,r=e.colorings,o=e.observedMutations,s=e.geneSortFn,c=e.t;if("click"!==t.event)return null;var u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},a.e.panel);u.maxHeight="70%";var m=t.node.n,S="tip"===t.type,x=1===m.fullTipCount,j=S?m.name:x?"Branch leading to ".concat(m.name):"Internal branch";return i.a.createElement("div",{style:a.e.modalContainer,onClick:function(){return n(t)}},i.a.createElement("div",{className:"panel",style:u,onClick:function(e){return d(e)}},i.a.createElement(v,null,j),i.a.createElement("table",null,i.a.createElement("tbody",null,!S&&f(c("Number of terminal tips"),m.fullTipCount),S&&i.a.createElement(b,{node:m,t:c}),i.a.createElement(w,{isTerminal:x,node:m,t:c}),!S&&f("Node name",m.name),S&&i.a.createElement(g,{node:m,t:c}),function(e){if(!e.node_attrs)return[];var t=["author","div","num_date","gisaid_epi_isl","genbank_accession","accession","url"];return Object.keys(e.node_attrs).filter((function(e){return!t.includes(e)}))}(m).map((function(e){return i.a.createElement(O,{node:m,trait:e,colorings:r,key:e,isTerminal:x})})),S&&i.a.createElement(y,{node:m}),f("",""))),i.a.createElement(l.a,{node:m,geneSortFn:s,isTip:S,observedMutations:o}),i.a.createElement("p",{style:a.e.comment},c("Click outside this box to go back to the tree"))))}}}]);