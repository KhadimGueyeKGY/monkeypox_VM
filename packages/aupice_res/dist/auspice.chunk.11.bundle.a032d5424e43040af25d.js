(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1178:function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r),i=n(817),a=n(1157),c=(n(841),n(796)),s=n(843),l=n(1165),u=n(842),p=n(923),f=n(1153),y=n(1154),d=n(930),h=n(1167),v=n(1170),b=n(822),m=n(862),g=n(828),x=n(832),j=n(953);function O(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);s=!0);}catch(t){l=!0,o=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var S=function(t,e){if(e&&e[t])return e[t].title;if(Object(g.f)(t)){var n=Object(g.a)(t);return n.aa?"Genotype at ".concat(n.gene," pos ").concat(n.positions.join(", ")):"Genotype at Nuc. ".concat(n.positions.join(", "))}return t},k=function(t,e,n){return e<n?t?"and normalized to 100% at each time point for ".concat(e," out of a total of ").concat(n," tips"):"as a fraction of all sequences at each time point showing ".concat(e," out of a total of ").concat(n," tips"):""},P=function(t,e){return{y:Object(u.a)().domain([0,e]).range([t.height-t.spaceBottom,t.spaceTop]),numTicksY:5}},A=function(t,e,n){!function(t){t.selectAll(".y.axis").remove()}(t);var r=Object(v.a)(".0%");t.append("g").attr("class","y axis").attr("transform","translate(".concat(e.spaceLeft,",0)")).style("font-family",b.b).style("font-size","12px").call(Object(p.b)(n.y).ticks(n.numTicksY).tickFormat(r))},R=function(t,e,n,r){if(n){!function(t){t.selectAll(".projection-pivot").remove(),t.selectAll(".projection-text").remove()}(t),t.append("g").attr("class","projection-pivot").append("line").attr("x1",e.x(parseFloat(n))).attr("x2",e.x(parseFloat(n))).attr("y1",e.y(1)).attr("y2",e.y(0)).style("visibility","visible").style("stroke","rgba(55,55,55,0.9)").style("stroke-width","2").style("stroke-dasharray","4 4");var o=.5*(e.x(parseFloat(n))+e.x.range()[1]);t.append("g").attr("class","projection-text").append("text").attr("x",o).attr("y",e.y(1)-3).style("pointer-events","none").style("fill","#555").style("font-family",b.b).style("font-size",12).style("alignment-baseline","bottom").style("text-anchor","middle").text(r("Projection"))}};function q(){Object(a.a)(this).attr("opacity",1)}function E(){Object(a.a)(this).attr("opacity",.85),Object(a.a)("#freqinfo").style("visibility","hidden"),Object(a.a)("#vline").style("visibility","hidden")}var z,B=function(t){var e=t.matrix,n=t.pivots,r=t.colorScale,o=function(t,e){for(var n=e.legendValues.filter((function(t){return void 0!==t})).reverse().map((function(t){return t.toString()})),r=n.length-1;r>=0;--r)-1===t.indexOf(n[r])&&n.splice(r,1);return t.length>n.length&&t.forEach((function(t){-1===n.indexOf(t)&&n.push(t)})),n}(Array.from(e.keys()),r),i=function(t,e,n){for(var r=[],o=0;o<t.length;o++){for(var i=[],a=0;a<e;a++)if(0===o)i.push([0,n.get(t[o])[a]]);else{var c=r[o-1][a][1];i.push([c,n.get(t[o])[a]+c])}r.push(i)}return r}(o,n.length,e),a=function(t){return t[t.length-1].reduce((function(t,e){return Math.max(t,e[1])}),0)}(i);return{categories:o,series:i,maxY:a}},G=function(t,e,n,r){var o,i=n.categories,c=n.series,s=r.colorBy,u=r.colorScale,p=r.colorOptions,f=r.pivots,y=r.projection_pivot,v=r.t;(o=t).selectAll("path").remove(),o.selectAll("line").remove(),o.selectAll("text").remove();var g=function(t,e){return function(n,r){return t[r]===m.d?"#ADB1B3":Object(d.g)(e.scale(t[r])).toString()}}(i,u),j=function(t,e){return e.continuous?t.map((function(t){return t===m.d?m.d:"".concat(e.legendBounds[t][0].toFixed(2)," - ").concat(e.legendBounds[t][1].toFixed(2))})):t.slice()}(i,u),w=Object(h.a)().x((function(t,n){return e.x(f[n])})).y0((function(t){return e.y(t[0])})).y1((function(t){return e.y(t[1])}));t.selectAll(".stream").data(c).enter().append("path").attr("d",w).attr("fill",g).attr("opacity",.85).on("mouseover",q).on("mouseout",E).on("mousemove",(function(t,n){var r=O(Object(l.a)(this),1)[0],o=e.x.invert(r),i=f.reduce((function(t,e,n,r){return Math.abs(e-o)<Math.abs(r[t]-o)?n:t}),0),c=100*(t[i][1]-t[i][0]),u=c<1?"<1%":Math.round(c)+"%",d=e.x(f[i]),h=e.y(t[i][1]),m=e.y(t[i][0]);Object(a.a)("#vline").style("visibility","visible").attr("x1",d).attr("x2",d).attr("y1",h).attr("y2",m);var g=d>.5*e.x.range()[1]?"":"".concat(d+25,"px"),w=d>.5*e.x.range()[1]?"".concat(e.x.range()[1]-d+25,"px"):"",k=h>.5*e.y(0)?"".concat(e.y(0)-50,"px"):"".concat(h+25,"px"),P=v("Frequency");y&&f[i]>y&&(P=v("Projected frequency")),Object(a.a)("#freqinfo").style("left",g).style("right",w).style("top",k).style("padding-left","10px").style("padding-right","10px").style("padding-top","0px").style("padding-bottom","0px").style("visibility","visible").style("background-color","rgba(55,55,55,0.9)").style("color","white").style("font-family",b.b).style("font-size",18).style("line-height",1).style("font-weight",300).html("<p>".concat(S(s,p),": ").concat(j[n],"</p>\n        <p>").concat(v("Time point"),": ").concat(Object(x.g)(f[i]),"</p>\n        <p>").concat(P,": ").concat(u,"</p>"))})),t.append("line").attr("id","vline").style("visibility","hidden").style("pointer-events","none").style("stroke","rgba(55,55,55,0.9)").style("stroke-width",4),function(t,e,n,r,o){var i=function(t,e,n,r){return t.map((function(t){for(var o=.15*n.y.domain()[1],i=0;i<t.length-r;i++){var a=i+r;if(t[i][1]-t[i][0]>o&&t[a][1]-t[a][0]>o)return[n.x(e[i+1]),(n.y((t[i][1]+t[i][0])/2)+n.y((t[a][1]+t[a][0])/2))/2]}return[void 0,void 0]}))}(e,n,o,3);t.selectAll(".streamLabels").data(r).enter().append("text").attr("x",(function(t,e){return i[e][0]})).attr("y",(function(t,e){return i[e][1]})).style("pointer-events","none").style("fill","white").style("font-family",b.b).style("font-size",14).style("alignment-baseline","middle").text((function(t,e){return i[e][0]?t:""}))}(t,c,f,j,e)};n(920);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){Y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Y(t,e,n){return(e=C(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C(r.key),r)}}function C(t){var e=function(t,e){if("object"!==_(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===_(e)?e:String(e)}function M(t,e){return(M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=V(t);if(e){var o=V(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I(this,n)}}function I(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var N=Object(c.b)((function(t){return{data:t.frequencies.data,pivots:t.frequencies.pivots,matrix:t.frequencies.matrix,nodes:t.tree.nodes,projection_pivot:t.frequencies.projection_pivot,version:t.frequencies.version,browserDimensions:t.browserDimensions.browserDimensions,colorBy:t.controls.colorBy,colorScale:t.controls.colorScale,colorOptions:t.metadata.colorings,normalizeFrequencies:t.controls.normalizeFrequencies}}))(z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e)}(c,t);var e,n,r,i=L(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=i.call(this,t)).state={maxY:0},e}return e=c,(n=[{key:"calcChartGeom",value:function(t,e){return{width:t,height:e,spaceLeft:40,spaceRight:10,spaceBottom:20,spaceTop:10}}},{key:"recomputeRedrawAll",value:function(t,e){var n=this.calcChartGeom(e.width,e.height),r=B(T({},e));t.maxY=r.maxY,t.categories=r.categories;var o=function(t,e){return{x:Object(u.a)().domain([e[0],e[e.length-1]]).range([t.spaceLeft,t.width-t.spaceRight])}}(n,e.pivots),i=P(n,r.maxY);t.scales=T(T({},o),i),function(t,e,n){var r=n.x.domain(),o=n.x.range(),i=Object(j.b)(Object(f.a)(r),Object(y.a)(r),o[1]-o[0]).majorGridPoints;!function(t){t.selectAll(".x.axis").remove()}(t),t.append("g").attr("class","x axis").attr("transform","translate(0,".concat(e.height-e.spaceBottom,")")).style("font-family",b.b).style("font-size","12px").call(Object(p.a)(n.x).tickValues(i.map((function(t){return t.position}))).tickFormat((function(t,e){return i[e].name})))}(t.svg,n,o),A(t.svg,n,i),G(t.svgStreamGroup,t.scales,r,T({},e)),R(t.svg,t.scales,e.projection_pivot,e.t)}},{key:"recomputeRedrawPartial",value:function(t,e,n){var r,o=B(T({},n)),i=t.maxY!==o.maxY,a=this.calcChartGeom(n.width,n.height);if(i){var c=P(a,o.maxY);A(t.svg,a,c),r=T(T({},t.scales),c)}else r=T({},t.scales);return G(t.svgStreamGroup,r,o,T({},n)),i&&R(t.svg,r,n.projection_pivot,n.t),T(T({},t),{},{scales:r,maxY:o.maxY,categories:o.categories})}},{key:"componentDidMount",value:function(){var t=Object(a.a)(this.domRef),e=t.append("g"),n={svg:t,svgStreamGroup:e};this.props.matrix&&this.recomputeRedrawAll(n,this.props),this.setState(n)}},{key:"componentWillReceiveProps",value:function(t){if(this.props.version===t.version);else if(!this.props.loaded&&t.loaded){var e=T({},this.state);this.recomputeRedrawAll(e,t),this.setState(e)}else{var n=this.recomputeRedrawPartial(this.state,this.props,t);n&&this.setState(n)}}},{key:"componentDidUpdate",value:function(t){if(t.width!==this.props.width||t.height!==this.props.height){var e=T({},this.state);this.recomputeRedrawAll(e,this.props),this.setState(e)}}},{key:"render",value:function(){var t=this,e=this.props.t,n=this.props.nodes[0],r=n.tipCount,i=n.fullTipCount;return o.a.createElement(s.a,{title:"".concat(e("Frequencies")," (").concat(e("colored by")," ").concat(S(this.props.colorBy,this.props.colorOptions)," ").concat(e(k(this.props.normalizeFrequencies,r,i)),")")},o.a.createElement("div",{id:"freqinfo",style:{zIndex:20,position:"absolute",borderRadius:"5px",padding:"10px",backgroundColor:"hsla(0,0%,100%,.9)",pointerEvents:"none",visibility:"hidden",fontSize:"14px"}}),o.a.createElement("svg",{id:"d3frequenciesSVG",width:this.props.width,height:this.props.height,style:{pointerEvents:"auto",overflow:"visible"}},o.a.createElement("g",{ref:function(e){t.domRef=e},id:"d3frequencies"})))}}])&&D(e.prototype,n),r&&D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(o.a.Component))||z,H=Object(i.a)()(N);e.default=H},920:function(t,e,n){var r=n(921);"string"==typeof r&&(r=[[t.i,r,""]]);n(235)(r,{});r.locals&&(t.exports=r.locals)},921:function(t,e,n){(t.exports=n(338)(!1)).push([t.i,'\n/* Variables - keep in sync with globalStyles.js*/\n:root {\n  --darkGrey: #333;\n  --medGrey: #888;\n}\n\n#d3entropy .overlay {\n  fill: none;\n  pointer-events: all;\n}\n\n#d3entropy .brush {\n  stroke: none;\n}\n\n#d3entropy .niceText {\n  font-family: "Lato", "Helvetica Neue", "Helvetica", "sans-serif";\n  font-size: 14px;\n  font-style: italic;\n  color: var(--medGrey);\n}\n\n.brush .selection {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n',""])}}]);